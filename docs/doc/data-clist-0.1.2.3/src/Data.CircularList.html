<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
A simple purely functional circular list, or ring, data type.

Lets describe what we mean by 'ring'. A ring is a circular data structure
such that if you continue rotating the ring, you'll eventually return to
the element you first observed.

All of our analogies involve sitting at a table who's top surface rotates
about its center axis (think of those convenient rotating platforms one
often finds in an (Americanized) Chinese Restaurant).

Only the closest item on the table is avialable to us. In order to reach
other elements on the table, we need to rotate the table to the left or
the right.

Our convention for this problem says that rotations to the right are a
forward motion while rotations to the left are backward motions.

We'll use the following circular list for our examples:

&gt;   8 7 6
&gt;  9     5
&gt; A       4
&gt; B       3
&gt;  C     2
&gt;   D 0 1
&gt;     ^

The pointer at the bottom represents our position at the table. The element
currently in front of is is referred to as the `focus`. So, in this case,
our focus is 0.

If we were to rotate the table to the right using the `rotR` operation, we'd
have the following table.

&gt;   9 8 7
&gt;  A     6
&gt; B       5
&gt; C       4
&gt;  D     3
&gt;   0 1 2
&gt;     ^

This yields 1 as our new focus. Rotating this table left would return 0 to
the focus position.

-}</span><span>
</span><span id="line-48"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.CircularList</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Data Types</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier">CList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Functions</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Creation of CLists</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#fromList"><span class="hs-identifier">fromList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#singleton"><span class="hs-identifier">singleton</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Update of CList</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#update"><span class="hs-identifier">update</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#reverseDirection"><span class="hs-identifier">reverseDirection</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Converting CLists to Lists</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#leftElements"><span class="hs-identifier">leftElements</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#rightElements"><span class="hs-identifier">rightElements</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#toList"><span class="hs-identifier">toList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#toInfList"><span class="hs-identifier">toInfList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Extraction and Accumulation</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#focus"><span class="hs-identifier">focus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#insertL"><span class="hs-identifier">insertL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#insertR"><span class="hs-identifier">insertR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#removeL"><span class="hs-identifier">removeL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#removeR"><span class="hs-identifier">removeR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Manipulation of Focus</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#allRotations"><span class="hs-identifier">allRotations</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#rotR"><span class="hs-identifier">rotR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#rotL"><span class="hs-identifier">rotL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#rotN"><span class="hs-identifier">rotN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#rotNR"><span class="hs-identifier">rotNR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#rotNL"><span class="hs-identifier">rotNL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#rotateTo"><span class="hs-identifier">rotateTo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier">findRotateTo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** List-like functions</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#filterR"><span class="hs-identifier">filterR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#filterL"><span class="hs-identifier">filterL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#foldrR"><span class="hs-identifier">foldrR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#foldrL"><span class="hs-identifier">foldrL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#foldlR"><span class="hs-identifier">foldlR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#foldlL"><span class="hs-identifier">foldlL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Manipulation of Packing</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#balance"><span class="hs-identifier">balance</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#packL"><span class="hs-identifier">packL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#packR"><span class="hs-identifier">packR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Information</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Data.CircularList.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.CircularList.html#size"><span class="hs-identifier">size</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">unfoldr</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.Arbitrary</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.Gen</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | A functional ring type.</span><span>
</span><span id="line-85"></span><span class="hs-keyword">data</span><span> </span><span id="CList"><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span></span><span> </span><span id="local-6989586621679071530"><span class="annot"><a href="#local-6989586621679071530"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Empty"><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span></span><span>
</span><span id="line-86"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="CList"><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679071530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">{- Creating CLists -}</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | An empty CList.</span><span>
</span><span id="line-91"></span><span id="local-6989586621679071303"><span class="annot"><a href="Data.CircularList.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071303"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-92"></span><span id="empty"><span class="annot"><span class="annottext">empty :: CList a
</span><a href="Data.CircularList.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- |Make a (balanced) CList from a list.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679071442"><span class="annot"><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071442"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-96"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: [a] -&gt; CList a
</span><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span id="local-6989586621679071302"><span class="annot"><span class="annottext">a :: [a]
</span><a href="#local-6989586621679071302"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679071301"><span class="annot"><span class="annottext">i :: a
</span><a href="#local-6989586621679071301"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071300"><span class="annot"><span class="annottext">is :: [a]
</span><a href="#local-6989586621679071300"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679071299"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679071299"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071302"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-98"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679071297"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071297"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679071296"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071296"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071299"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071300"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-99"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071296"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071301"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071297"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679071504"><span class="annot"><a href="Data.CircularList.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679071504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071504"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-102"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: a -&gt; CList a
</span><a href="Data.CircularList.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621679071292"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679071292"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071292"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">{- Updating of CLists -}</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- |Replaces the current focus with a new focus.</span><span>
</span><span id="line-107"></span><span id="local-6989586621679071291"><span class="annot"><a href="Data.CircularList.html#update"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679071291"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071291"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071291"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-108"></span><span id="update"><span class="annot"><span class="annottext">update :: a -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#update"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679071290"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679071290"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071290"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Data.CircularList.html#update"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span id="local-6989586621679071289"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679071289"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071288"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071288"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679071287"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071287"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071288"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071289"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071287"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- |Reverse the direction of rotation.</span><span>
</span><span id="line-112"></span><span id="local-6989586621679071286"><span class="annot"><a href="Data.CircularList.html#reverseDirection"><span class="hs-identifier hs-type">reverseDirection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071286"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071286"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-113"></span><span id="reverseDirection"><span class="annot"><span class="annottext">reverseDirection :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#reverseDirection"><span class="hs-identifier hs-var hs-var">reverseDirection</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Data.CircularList.html#reverseDirection"><span class="hs-identifier hs-var">reverseDirection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071285"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071285"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071284"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071284"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071283"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071283"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071283"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071284"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071285"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">{- Creating Lists -}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- |Starting with the focus, go left and accumulate all</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- elements of the CList in a list.</span><span>
</span><span id="line-120"></span><span id="local-6989586621679071282"><span class="annot"><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-type">leftElements</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071282"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071282"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-121"></span><span id="leftElements"><span class="annot"><span class="annottext">leftElements :: CList a -&gt; [a]
</span><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var hs-var">leftElements</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var">leftElements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071281"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071281"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071280"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071280"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071279"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071279"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071281"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071279"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- |Starting with the focus, go right and accumulate all</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- elements of the CList in a list.</span><span>
</span><span id="line-126"></span><span id="local-6989586621679071515"><span class="annot"><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-type">rightElements</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071515"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-127"></span><span id="rightElements"><span class="annot"><span class="annottext">rightElements :: CList a -&gt; [a]
</span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var hs-var">rightElements</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071278"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071278"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071277"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071277"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071276"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071276"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071277"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071276"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071278"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- |Make a list from a CList.</span><span>
</span><span id="line-131"></span><span id="local-6989586621679071275"><span class="annot"><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071275"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-132"></span><span id="toList"><span class="annot"><span class="annottext">toList :: CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- |Make a CList into an infinite list.</span><span>
</span><span id="line-135"></span><span id="local-6989586621679071274"><span class="annot"><a href="Data.CircularList.html#toInfList"><span class="hs-identifier hs-type">toInfList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071274"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071274"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-136"></span><span id="toInfList"><span class="annot"><span class="annottext">toInfList :: CList a -&gt; [a]
</span><a href="Data.CircularList.html#toInfList"><span class="hs-identifier hs-var hs-var">toInfList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; (CList a -&gt; [a]) -&gt; CList a -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">{- Extraction and Accumulation -}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- |Return the focus of the CList.</span><span>
</span><span id="line-141"></span><span id="local-6989586621679071470"><span class="annot"><a href="Data.CircularList.html#focus"><span class="hs-identifier hs-type">focus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071470"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679071470"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-142"></span><span id="focus"><span class="annot"><span class="annottext">focus :: CList a -&gt; Maybe a
</span><a href="Data.CircularList.html#focus"><span class="hs-identifier hs-var hs-var">focus</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Data.CircularList.html#focus"><span class="hs-identifier hs-var">focus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679071271"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071271"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071271"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- |Insert an element into the CList as the new focus. The</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- old focus is now the next element to the right.</span><span>
</span><span id="line-147"></span><span id="local-6989586621679071270"><span class="annot"><a href="Data.CircularList.html#insertR"><span class="hs-identifier hs-type">insertR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679071270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071270"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-148"></span><span id="insertR"><span class="annot"><span class="annottext">insertR :: a -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#insertR"><span class="hs-identifier hs-var hs-var">insertR</span></a></span></span><span> </span><span id="local-6989586621679071269"><span class="annot"><span class="annottext">i :: a
</span><a href="#local-6989586621679071269"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071269"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span class="annot"><a href="Data.CircularList.html#insertR"><span class="hs-identifier hs-var">insertR</span></a></span><span> </span><span id="local-6989586621679071268"><span class="annot"><span class="annottext">i :: a
</span><a href="#local-6989586621679071268"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071267"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071267"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071266"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071266"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071265"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071265"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071267"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071268"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071266"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071265"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- |Insert an element into the CList as the new focus. The</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- old focus is now the next element to the left.</span><span>
</span><span id="line-153"></span><span id="local-6989586621679071264"><span class="annot"><a href="Data.CircularList.html#insertL"><span class="hs-identifier hs-type">insertL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679071264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071264"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-154"></span><span id="insertL"><span class="annot"><span class="annottext">insertL :: a -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#insertL"><span class="hs-identifier hs-var hs-var">insertL</span></a></span></span><span> </span><span id="local-6989586621679071263"><span class="annot"><span class="annottext">i :: a
</span><a href="#local-6989586621679071263"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071263"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Data.CircularList.html#insertL"><span class="hs-identifier hs-var">insertL</span></a></span><span> </span><span id="local-6989586621679071262"><span class="annot"><span class="annottext">i :: a
</span><a href="#local-6989586621679071262"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071261"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071261"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071260"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071259"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071259"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071260"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071261"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071262"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071259"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- |Remove the focus from the CList. The new focus is the</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- next element to the left.</span><span>
</span><span id="line-159"></span><span id="local-6989586621679071258"><span class="annot"><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-type">removeL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071258"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071258"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-160"></span><span id="removeL"><span class="annot"><span class="annottext">removeL :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var hs-var">removeL</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var">removeL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var">removeL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071257"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679071257"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071256"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071256"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679071255"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071255"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071256"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071257"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071255"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var">removeL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679071254"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071254"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071253"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071253"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071252"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071252"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071254"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-164"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071252"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071253"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- |Remove the focus from the CList.</span><span>
</span><span id="line-167"></span><span id="local-6989586621679071251"><span class="annot"><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-type">removeR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071251"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-168"></span><span id="removeR"><span class="annot"><span class="annottext">removeR :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var hs-var">removeR</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var">removeR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var">removeR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071250"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071250"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071249"><span class="annot"><span class="annottext">r :: a
</span><a href="#local-6989586621679071249"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071248"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071248"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071250"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071249"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071248"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var">removeR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071247"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071247"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071246"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071246"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071245"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071245"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071247"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-172"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071246"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071245"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">{- Manipulating Rotation -}</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- |Return all possible rotations of the provided 'CList', where the</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- focus is the provided 'CList'.</span><span>
</span><span id="line-178"></span><span id="local-6989586621679071469"><span class="annot"><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-type">allRotations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071469"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-179"></span><span id="allRotations"><span class="annot"><span class="annottext">allRotations :: CList a -&gt; CList (CList a)
</span><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var hs-var">allRotations</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList (CList a)
forall a. a -&gt; CList a
</span><a href="Data.CircularList.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var">allRotations</span></a></span><span> </span><span id="local-6989586621679071244"><span class="annot"><span class="annottext">cl :: CList a
</span><a href="#local-6989586621679071244"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CList a] -&gt; CList a -&gt; [CList a] -&gt; CList (CList a)
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[CList a]
</span><a href="#local-6989586621679071243"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071244"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">[CList a]
</span><a href="#local-6989586621679071242"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679071243"><span class="annot"><span class="annottext">ls :: [CList a]
</span><a href="#local-6989586621679071243"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Maybe (CList a, CList a)) -&gt; CList a -&gt; [CList a]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CList a -&gt; (CList a, CList a))
-&gt; Maybe (CList a) -&gt; Maybe (CList a, CList a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CList a -&gt; CList a -&gt; (CList a, CList a))
-&gt; CList a -&gt; (CList a, CList a)
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (CList a) -&gt; Maybe (CList a, CList a))
-&gt; (CList a -&gt; Maybe (CList a))
-&gt; CList a
-&gt; Maybe (CList a, CList a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Maybe (CList a)
forall a. CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#mRotL"><span class="hs-identifier hs-var">mRotL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071244"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679071242"><span class="annot"><span class="annottext">rs :: [CList a]
</span><a href="#local-6989586621679071242"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Maybe (CList a, CList a)) -&gt; CList a -&gt; [CList a]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CList a -&gt; (CList a, CList a))
-&gt; Maybe (CList a) -&gt; Maybe (CList a, CList a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CList a -&gt; CList a -&gt; (CList a, CList a))
-&gt; CList a -&gt; (CList a, CList a)
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (CList a) -&gt; Maybe (CList a, CList a))
-&gt; (CList a -&gt; Maybe (CList a))
-&gt; CList a
-&gt; Maybe (CList a, CList a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Maybe (CList a)
forall a. CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#mRotR"><span class="hs-identifier hs-var">mRotR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071244"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- |Rotate the focus to the previous (left) element.</span><span>
</span><span id="line-186"></span><span id="local-6989586621679071239"><span class="annot"><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-type">rotL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071239"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071239"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-187"></span><span id="rotL"><span class="annot"><span class="annottext">rotL :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var hs-var">rotL</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var">rotL</span></a></span><span> </span><span id="local-6989586621679071238"><span class="annot"><span class="annottext">r :: CList a
</span><a href="#local-6989586621679071238"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071238"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var">rotL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071237"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679071237"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071236"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071236"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679071235"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071235"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071234"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071234"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071236"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071237"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071235"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071234"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var">rotL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679071233"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071233"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071232"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071232"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071231"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679071231"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071230"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071230"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071232"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-191"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071230"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071231"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071233"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- |A non-cyclic version of 'rotL'; that is, only rotate the focus if</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- there is a previous (left) element to rotate to.</span><span>
</span><span id="line-195"></span><span id="local-6989586621679071495"><span class="annot"><a href="Data.CircularList.html#mRotL"><span class="hs-identifier hs-type">mRotL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071495"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-196"></span><span id="mRotL"><span class="annot"><span class="annottext">mRotL :: CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#mRotL"><span class="hs-identifier hs-var hs-var">mRotL</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071229"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679071229"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071228"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071228"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679071227"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071227"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071226"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071226"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Maybe (CList a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Maybe (CList a)) -&gt; CList a -&gt; Maybe (CList a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071228"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071229"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071227"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071226"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Data.CircularList.html#mRotL"><span class="hs-identifier hs-var">mRotL</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CList a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- |Rotate the focus to the next (right) element.</span><span>
</span><span id="line-200"></span><span id="local-6989586621679071225"><span class="annot"><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-type">rotR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071225"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-201"></span><span id="rotR"><span class="annot"><span class="annottext">rotR :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var hs-var">rotR</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var">rotR</span></a></span><span> </span><span id="local-6989586621679071224"><span class="annot"><span class="annottext">r :: CList a
</span><a href="#local-6989586621679071224"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071224"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var">rotR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071223"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071223"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679071222"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071222"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071221"><span class="annot"><span class="annottext">r :: a
</span><a href="#local-6989586621679071221"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071220"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071220"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071222"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071223"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071221"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071220"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var">rotR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071219"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071219"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679071218"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071218"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071217"><span class="annot"><span class="annottext">r :: a
</span><a href="#local-6989586621679071217"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071216"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071216"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071219"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-205"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071218"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071217"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071216"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- |A non-cyclic version of 'rotL'; that is, only rotate the focus if</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- there is a previous (left) element to rotate to.</span><span>
</span><span id="line-209"></span><span id="local-6989586621679071215"><span class="annot"><a href="Data.CircularList.html#mRotR"><span class="hs-identifier hs-type">mRotR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071215"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-210"></span><span id="mRotR"><span class="annot"><span class="annottext">mRotR :: CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#mRotR"><span class="hs-identifier hs-var hs-var">mRotR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071214"><span class="annot"><span class="annottext">ls :: [a]
</span><a href="#local-6989586621679071214"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679071213"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071213"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071212"><span class="annot"><span class="annottext">r :: a
</span><a href="#local-6989586621679071212"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679071211"><span class="annot"><span class="annottext">rs :: [a]
</span><a href="#local-6989586621679071211"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Maybe (CList a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Maybe (CList a)) -&gt; CList a -&gt; Maybe (CList a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071213"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071214"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071212"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071211"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Data.CircularList.html#mRotR"><span class="hs-identifier hs-var">mRotR</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CList a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- |Rotate the focus the specified number of times; if the index is</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- positive then it is rotated to the right; otherwise it is rotated</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- to the left.</span><span>
</span><span id="line-216"></span><span id="local-6989586621679071480"><span class="annot"><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-type">rotN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071480"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071480"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-217"></span><span id="rotN"><span class="annot"><span class="annottext">rotN :: Int -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var hs-var">rotN</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679071210"><span class="annot"><span class="annottext">cl :: CList a
</span><a href="#local-6989586621679071210"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071210"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a></span><span> </span><span id="local-6989586621679071209"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679071209"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679071208"><span class="annot"><span class="annottext">cl :: CList a
</span><a href="#local-6989586621679071208"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; CList a) -&gt; CList a -&gt; [CList a]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="#local-6989586621679071206"><span class="hs-identifier hs-var">rot</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071208"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">[CList a] -&gt; Int -&gt; CList a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071204"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679071204"><span class="annot"><span class="annottext">n' :: Int
</span><a href="#local-6989586621679071204"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071209"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679071206"><span class="annot"><span class="annottext">rot :: CList a -&gt; CList a
</span><a href="#local-6989586621679071206"><span class="hs-identifier hs-var hs-var">rot</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var">rotL</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var">rotR</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- |A wrapper around 'rotN' that doesn't rotate the CList if @n &lt;= 0@.</span><span>
</span><span id="line-226"></span><span id="local-6989586621679071201"><span class="annot"><a href="Data.CircularList.html#rotNR"><span class="hs-identifier hs-type">rotNR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071201"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-227"></span><span id="rotNR"><span class="annot"><span class="annottext">rotNR :: Int -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotNR"><span class="hs-identifier hs-var hs-var">rotNR</span></a></span></span><span> </span><span id="local-6989586621679071200"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679071200"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679071199"><span class="annot"><span class="annottext">cl :: CList a
</span><a href="#local-6989586621679071199"><span class="hs-identifier hs-var">cl</span></a></span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071200"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071199"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CList a -&gt; CList a
forall a. Int -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071200"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071199"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- |Rotate the focus the specified number of times to the left (but</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- don't rotate if @n &lt;= 0@).</span><span>
</span><span id="line-233"></span><span id="local-6989586621679071197"><span class="annot"><a href="Data.CircularList.html#rotNL"><span class="hs-identifier hs-type">rotNL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071197"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-234"></span><span id="rotNL"><span class="annot"><span class="annottext">rotNL :: Int -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotNL"><span class="hs-identifier hs-var hs-var">rotNL</span></a></span></span><span> </span><span id="local-6989586621679071196"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679071196"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679071195"><span class="annot"><span class="annottext">cl :: CList a
</span><a href="#local-6989586621679071195"><span class="hs-identifier hs-var">cl</span></a></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071196"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071195"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CList a -&gt; CList a
forall a. Int -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071196"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071195"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- |Rotate the 'CList' such that the specified element (if it exists)</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- is focused.</span><span>
</span><span id="line-240"></span><span id="local-6989586621679071194"><span class="annot"><a href="Data.CircularList.html#rotateTo"><span class="hs-identifier hs-type">rotateTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679071194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-241"></span><span id="rotateTo"><span class="annot"><span class="annottext">rotateTo :: a -&gt; CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#rotateTo"><span class="hs-identifier hs-var hs-var">rotateTo</span></a></span></span><span> </span><span id="local-6989586621679071193"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679071193"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; CList a -&gt; Maybe (CList a)
forall a. (a -&gt; Bool) -&gt; CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier hs-var">findRotateTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071193"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- |Attempt to rotate the 'CList' such that focused element matches</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- the supplied predicate.</span><span>
</span><span id="line-245"></span><span id="local-6989586621679071477"><span class="annot"><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier hs-type">findRotateTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071477"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-246"></span><span id="findRotateTo"><span class="annot"><span class="annottext">findRotateTo :: (a -&gt; Bool) -&gt; CList a -&gt; Maybe (CList a)
</span><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier hs-var hs-var">findRotateTo</span></a></span></span><span> </span><span id="local-6989586621679071192"><span class="annot"><span class="annottext">p :: a -&gt; Bool
</span><a href="#local-6989586621679071192"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Bool) -&gt; [CList a] -&gt; Maybe (CList a)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; (a -&gt; Bool) -&gt; Maybe a -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679071192"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Bool) -&gt; (CList a -&gt; Maybe a) -&gt; CList a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Maybe a
forall a. CList a -&gt; Maybe a
</span><a href="Data.CircularList.html#focus"><span class="hs-identifier hs-var">focus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CList a] -&gt; Maybe (CList a))
-&gt; (CList a -&gt; [CList a]) -&gt; CList a -&gt; Maybe (CList a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList (CList a) -&gt; [CList a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(CList (CList a) -&gt; [CList a])
-&gt; (CList a -&gt; CList (CList a)) -&gt; CList a -&gt; [CList a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList (CList a)
forall a. CList a -&gt; CList (CList a)
</span><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var">allRotations</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">{- List-like functions -}</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- |Remove those elements that do not satisfy the supplied predicate,</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- rotating to the right if the focus does not satisfy the predicate.</span><span>
</span><span id="line-252"></span><span id="local-6989586621679071190"><span class="annot"><a href="Data.CircularList.html#filterR"><span class="hs-identifier hs-type">filterR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071190"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-253"></span><span id="filterR"><span class="annot"><span class="annottext">filterR :: (a -&gt; Bool) -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#filterR"><span class="hs-identifier hs-var hs-var">filterR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; CList a) -&gt; (a -&gt; Bool) -&gt; CList a -&gt; CList a
forall a. (CList a -&gt; CList a) -&gt; (a -&gt; Bool) -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-var">filterCL</span></a></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var">removeR</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- |As with 'filterR', but rotates to the /left/ if the focus does not</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- satisfy the predicate.</span><span>
</span><span id="line-257"></span><span id="local-6989586621679071188"><span class="annot"><a href="Data.CircularList.html#filterL"><span class="hs-identifier hs-type">filterL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071188"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071188"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071188"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-258"></span><span id="filterL"><span class="annot"><span class="annottext">filterL :: (a -&gt; Bool) -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#filterL"><span class="hs-identifier hs-var hs-var">filterL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; CList a) -&gt; (a -&gt; Bool) -&gt; CList a -&gt; CList a
forall a. (CList a -&gt; CList a) -&gt; (a -&gt; Bool) -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-var">filterCL</span></a></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var">removeL</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- |Abstract away what to do with the focused element if it doesn't</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- match the predicate when filtering.</span><span>
</span><span id="line-262"></span><span id="local-6989586621679071467"><span class="annot"><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-type">filterCL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071467"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-263"></span><span id="filterCL"><span class="annot"><span class="annottext">filterCL :: (CList a -&gt; CList a) -&gt; (a -&gt; Bool) -&gt; CList a -&gt; CList a
</span><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-var hs-var">filterCL</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-264"></span><span class="annot"><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-var">filterCL</span></a></span><span> </span><span id="local-6989586621679071187"><span class="annot"><span class="annottext">rm :: CList a -&gt; CList a
</span><a href="#local-6989586621679071187"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span id="local-6989586621679071186"><span class="annot"><span class="annottext">p :: a -&gt; Bool
</span><a href="#local-6989586621679071186"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071185"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071185"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071184"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071184"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071183"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071183"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679071186"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071184"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071182"><span class="hs-identifier hs-var">cl'</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
</span><a href="#local-6989586621679071187"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071182"><span class="hs-identifier hs-var">cl'</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679071182"><span class="annot"><span class="annottext">cl' :: CList a
</span><a href="#local-6989586621679071182"><span class="hs-identifier hs-var hs-var">cl'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679071186"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071185"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071184"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679071186"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071183"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- |A right-fold, rotating to the right through the CList.</span><span>
</span><span id="line-271"></span><span id="local-6989586621679071180"><span id="local-6989586621679071181"><span class="annot"><a href="Data.CircularList.html#foldrR"><span class="hs-identifier hs-type">foldrR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071181"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071180"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071180"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071180"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071181"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071180"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-272"></span><span id="foldrR"><span class="annot"><span class="annottext">foldrR :: (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
</span><a href="Data.CircularList.html#foldrR"><span class="hs-identifier hs-var hs-var">foldrR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; [a]) -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
forall a b. (CList a -&gt; [a]) -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
</span><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier hs-var">foldrCL</span></a></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- |A right-fold, rotating to the left through the CList.</span><span>
</span><span id="line-275"></span><span id="local-6989586621679071177"><span id="local-6989586621679071178"><span class="annot"><a href="Data.CircularList.html#foldrL"><span class="hs-identifier hs-type">foldrL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071177"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071177"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071177"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071177"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-276"></span><span id="foldrL"><span class="annot"><span class="annottext">foldrL :: (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
</span><a href="Data.CircularList.html#foldrL"><span class="hs-identifier hs-var hs-var">foldrL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; [a]) -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
forall a b. (CList a -&gt; [a]) -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
</span><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier hs-var">foldrCL</span></a></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var">leftElements</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- |Abstract away direction for a foldr.</span><span>
</span><span id="line-279"></span><span id="local-6989586621679071460"><span id="local-6989586621679071461"><span class="annot"><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier hs-type">foldrCL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071460"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071460"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071460"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071460"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-280"></span><span id="foldrCL"><span class="annot"><span class="annottext">foldrCL :: (CList a -&gt; [a]) -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; CList a -&gt; b
</span><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier hs-var hs-var">foldrCL</span></a></span></span><span> </span><span id="local-6989586621679071176"><span class="annot"><span class="annottext">toL :: CList a -&gt; [a]
</span><a href="#local-6989586621679071176"><span class="hs-identifier hs-var">toL</span></a></span></span><span> </span><span id="local-6989586621679071175"><span class="annot"><span class="annottext">f :: a -&gt; b -&gt; b
</span><a href="#local-6989586621679071175"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071174"><span class="annot"><span class="annottext">a :: b
</span><a href="#local-6989586621679071174"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679071175"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679071174"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; b) -&gt; (CList a -&gt; [a]) -&gt; CList a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
</span><a href="#local-6989586621679071176"><span class="hs-identifier hs-var">toL</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- |A (strict) left-fold, rotating to the right through the CList.</span><span>
</span><span id="line-283"></span><span id="local-6989586621679071171"><span id="local-6989586621679071172"><span class="annot"><a href="Data.CircularList.html#foldlR"><span class="hs-identifier hs-type">foldlR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071172"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071171"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071172"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071172"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071171"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071172"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-284"></span><span id="foldlR"><span class="annot"><span class="annottext">foldlR :: (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
</span><a href="Data.CircularList.html#foldlR"><span class="hs-identifier hs-var hs-var">foldlR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList b -&gt; [b]) -&gt; (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
forall b a. (CList b -&gt; [b]) -&gt; (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
</span><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier hs-var">foldlCL</span></a></span><span> </span><span class="annot"><span class="annottext">CList b -&gt; [b]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- |A (strict) left-fold, rotating to the left through the CList.</span><span>
</span><span id="line-287"></span><span id="local-6989586621679071168"><span id="local-6989586621679071169"><span class="annot"><a href="Data.CircularList.html#foldlL"><span class="hs-identifier hs-type">foldlL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071168"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071168"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071169"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="foldlL"><span class="annot"><span class="annottext">foldlL :: (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
</span><a href="Data.CircularList.html#foldlL"><span class="hs-identifier hs-var hs-var">foldlL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList b -&gt; [b]) -&gt; (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
forall b a. (CList b -&gt; [b]) -&gt; (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
</span><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier hs-var">foldlCL</span></a></span><span> </span><span class="annot"><span class="annottext">CList b -&gt; [b]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var">leftElements</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- |Abstract away direction for a foldl'.</span><span>
</span><span id="line-291"></span><span id="local-6989586621679071450"><span id="local-6989586621679071451"><span class="annot"><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier hs-type">foldlCL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071451"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679071451"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071451"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071451"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679071450"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-292"></span><span id="foldlCL"><span class="annot"><span class="annottext">foldlCL :: (CList b -&gt; [b]) -&gt; (a -&gt; b -&gt; a) -&gt; a -&gt; CList b -&gt; a
</span><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier hs-var hs-var">foldlCL</span></a></span></span><span> </span><span id="local-6989586621679071167"><span class="annot"><span class="annottext">toL :: CList b -&gt; [b]
</span><a href="#local-6989586621679071167"><span class="hs-identifier hs-var">toL</span></a></span></span><span> </span><span id="local-6989586621679071166"><span class="annot"><span class="annottext">f :: a -&gt; b -&gt; a
</span><a href="#local-6989586621679071166"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071165"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679071165"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a
</span><a href="#local-6989586621679071166"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071165"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; a) -&gt; (CList b -&gt; [b]) -&gt; CList b -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList b -&gt; [b]
</span><a href="#local-6989586621679071167"><span class="hs-identifier hs-var">toL</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">{- Manipulating Packing -}</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- |Balance the CList. Equivalent to `fromList . toList`</span><span>
</span><span id="line-297"></span><span id="local-6989586621679071164"><span class="annot"><a href="Data.CircularList.html#balance"><span class="hs-identifier hs-type">balance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071164"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-298"></span><span id="balance"><span class="annot"><span class="annottext">balance :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#balance"><span class="hs-identifier hs-var hs-var">balance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; CList a
forall a. [a] -&gt; CList a
</span><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; CList a) -&gt; (CList a -&gt; [a]) -&gt; CList a -&gt; CList a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- |Move all elements to the left side of the CList.</span><span>
</span><span id="line-301"></span><span id="local-6989586621679071163"><span class="annot"><a href="Data.CircularList.html#packL"><span class="hs-identifier hs-type">packL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071163"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071163"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-302"></span><span id="packL"><span class="annot"><span class="annottext">packL :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#packL"><span class="hs-identifier hs-var hs-var">packL</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Data.CircularList.html#packL"><span class="hs-identifier hs-var">packL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071162"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071162"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071161"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071161"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071160"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071160"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071162"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071160"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071161"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- |Move all elements to the right side of the CList.</span><span>
</span><span id="line-306"></span><span id="local-6989586621679071159"><span class="annot"><a href="Data.CircularList.html#packR"><span class="hs-identifier hs-type">packR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071159"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071159"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-307"></span><span id="packR"><span class="annot"><span class="annottext">packR :: CList a -&gt; CList a
</span><a href="Data.CircularList.html#packR"><span class="hs-identifier hs-var hs-var">packR</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Data.CircularList.html#packR"><span class="hs-identifier hs-var">packR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071158"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071158"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071157"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071157"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071156"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071156"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071157"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071156"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071158"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">{- Information -}</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- |Returns true if the CList is empty.</span><span>
</span><span id="line-313"></span><span id="local-6989586621679071155"><span class="annot"><a href="Data.CircularList.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071155"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-314"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: CList a -&gt; Bool
</span><a href="Data.CircularList.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Data.CircularList.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- |Return the size of the CList.</span><span>
</span><span id="line-318"></span><span id="local-6989586621679071154"><span class="annot"><a href="Data.CircularList.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071154"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-319"></span><span id="size"><span class="annot"><span class="annottext">size :: CList a -&gt; Int
</span><a href="Data.CircularList.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Data.CircularList.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071153"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071153"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679071152"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071152"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071153"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071152"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">{- Instances -}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span id="local-6989586621679071150"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071145"><span id="local-6989586621679071147"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679071150"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071150"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span> </span><span id="local-6989586621679071143"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; CList a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679071141"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679071141"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679071140"><span class="annot"><span class="annottext">cl :: CList a
</span><a href="#local-6989586621679071140"><span class="hs-identifier hs-var">cl</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071141"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-326"></span><span>                   </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="hs-string">&quot;fromList &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071140"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span id="local-6989586621679071135"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071128"><span id="local-6989586621679071130"><span id="local-6989586621679071132"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679071135"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071135"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span> </span><span id="local-6989586621679071126"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS (CList a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></span></span><span> </span><span id="local-6989586621679071124"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679071124"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReadS (CList a) -&gt; ReadS (CList a)
forall a. Bool -&gt; ReadS a -&gt; ReadS a
</span><span class="hs-identifier hs-var">readParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071124"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReadS (CList a) -&gt; ReadS (CList a))
-&gt; ReadS (CList a) -&gt; ReadS (CList a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679071122"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621679071122"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>   </span><span class="hs-special">(</span><span class="hs-string">&quot;fromList&quot;</span><span class="hs-special">,</span><span id="local-6989586621679071121"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679071121"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS String
</span><span class="hs-identifier hs-var">lex</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679071122"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-331"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679071119"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679071119"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679071118"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679071118"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS [a]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679071121"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-332"></span><span>   </span><span class="annot"><span class="annottext">(CList a, String) -&gt; [(CList a, String)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; CList a
forall a. [a] -&gt; CList a
</span><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071119"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679071118"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span id="local-6989586621679071116"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071113"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679071116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679071111"><span class="annot"><span class="annottext">a :: CList a
</span><a href="#local-6989586621679071111"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679071110"><span class="annot"><span class="annottext">== :: CList a -&gt; CList a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679071109"><span class="annot"><span class="annottext">b :: CList a
</span><a href="#local-6989586621679071109"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Bool) -&gt; [CList a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071111"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Bool) -&gt; (CList a -&gt; [a]) -&gt; CList a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CList a] -&gt; Bool)
-&gt; (CList (CList a) -&gt; [CList a]) -&gt; CList (CList a) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList (CList a) -&gt; [CList a]
forall a. CList a -&gt; [a]
</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(CList (CList a) -&gt; Bool) -&gt; CList (CList a) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList (CList a)
forall a. CList a -&gt; CList (CList a)
</span><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var">allRotations</span></a></span><span> </span><span class="annot"><span class="annottext">CList a
</span><a href="#local-6989586621679071109"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span id="local-6989586621679071107"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679071107"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071107"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679071104"><span class="annot"><span class="annottext">rnf :: CList a -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071102"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071102"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071101"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071101"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071100"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071100"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071101"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-340"></span><span>                      </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071102"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-341"></span><span>                      </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071100"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span id="local-6989586621679071099"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621679071099"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679071099"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621679071095"><span class="annot"><span class="annottext">arbitrary :: Gen (CList a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen (CList a))] -&gt; Gen (CList a)
forall a. [(Int, Gen a)] -&gt; Gen a
</span><span class="hs-identifier hs-var">frequency</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Gen (CList a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen (CList a)
</span><a href="#local-6989586621679071092"><span class="hs-identifier hs-var">arbCList</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679071092"><span class="annot"><span class="annottext">arbCList :: Gen (CList a)
</span><a href="#local-6989586621679071092"><span class="hs-identifier hs-var hs-var">arbCList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>                </span><span id="local-6989586621679071091"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071091"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen [a]
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-347"></span><span>                </span><span id="local-6989586621679071090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071090"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-348"></span><span>                </span><span id="local-6989586621679071089"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071089"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen [a]
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-349"></span><span>                </span><span class="annot"><span class="annottext">CList a -&gt; Gen (CList a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(CList a -&gt; Gen (CList a)) -&gt; CList a -&gt; Gen (CList a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071091"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071090"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071089"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679071088"><span class="annot"><span class="annottext">shrink :: CList a -&gt; [CList a]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">shrink</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071086"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071086"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071085"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071085"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071084"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071084"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; [CList a] -&gt; [CList a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; [a] -&gt; CList a
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071083"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071082"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071081"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679071083"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071083"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071086"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>                                                      </span><span id="local-6989586621679071082"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071082"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071085"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-352"></span><span>                                                      </span><span id="local-6989586621679071081"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071081"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071084"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071078"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679071076"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; CList a -&gt; CList b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList b
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679071075"><span class="annot"><span class="annottext">fn :: a -&gt; b
</span><a href="#local-6989586621679071075"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071074"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071074"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071073"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071073"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071072"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071072"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b] -&gt; b -&gt; [b] -&gt; CList b
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679071075"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071074"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679071075"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071073"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679071075"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071072"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071039"><span id="local-6989586621679071041"><span id="local-6989586621679071043"><span id="local-6989586621679071045"><span id="local-6989586621679071047"><span id="local-6989586621679071049"><span id="local-6989586621679071051"><span id="local-6989586621679071053"><span id="local-6989586621679071055"><span id="local-6989586621679071057"><span id="local-6989586621679071059"><span id="local-6989586621679071061"><span id="local-6989586621679071063"><span id="local-6989586621679071065"><span id="local-6989586621679071067"><span id="local-6989586621679071070"><span class="annot"><span class="hs-identifier hs-type">F.Foldable</span></span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679071037"><span class="annot"><span class="annottext">foldMap :: (a -&gt; m) -&gt; CList a -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; CList a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">T.foldMapDefault</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679071026"><span id="local-6989586621679071028"><span id="local-6989586621679071030"><span class="annot"><span class="hs-identifier hs-type">T.Traversable</span></span><span> </span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-comment">-- | traverses the list from left to right, starting at the focus</span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679071024"><span class="annot"><span class="annottext">traverse :: (a -&gt; f b) -&gt; CList a -&gt; f (CList b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList b -&gt; f (CList b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CList b
forall a. CList a
</span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621679071022"><span class="annot"><span class="annottext">g :: a -&gt; f b
</span><a href="#local-6989586621679071022"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a></span><span> </span><span id="local-6989586621679071021"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679071021"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679071020"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679071020"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679071019"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679071019"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679071018"><span class="annot"><span class="annottext">f' :: b
</span><a href="#local-6989586621679071018"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679071017"><span class="annot"><span class="annottext">r' :: [b]
</span><a href="#local-6989586621679071017"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span id="local-6989586621679071016"><span class="annot"><span class="annottext">l' :: [b]
</span><a href="#local-6989586621679071016"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; b -&gt; [b] -&gt; CList b
forall a. [a] -&gt; a -&gt; [a] -&gt; CList a
</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679071016"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679071018"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679071017"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; [b] -&gt; [b] -&gt; CList b) -&gt; f b -&gt; f ([b] -&gt; [b] -&gt; CList b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679071022"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071020"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-366"></span><span>                                                           </span><span class="annot"><span class="annottext">f ([b] -&gt; [b] -&gt; CList b) -&gt; f [b] -&gt; f ([b] -&gt; CList b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; [a] -&gt; f [b]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">T.traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679071022"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071019"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-367"></span><span>                                                           </span><span class="annot"><span class="annottext">f ([b] -&gt; CList b) -&gt; f [b] -&gt; f (CList b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; [a] -&gt; f [b]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">T.traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679071022"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679071021"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-368"></span></pre></body></html>