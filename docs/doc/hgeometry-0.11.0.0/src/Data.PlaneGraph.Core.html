<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      :  Data.PlaneGraph.Core</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Data type for planar graphs embedded in \(\mathbb{R}^2\). For functions that</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- export faces and edges etc, we assume the graph has a (planar) straight line</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- embedding.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.PlaneGraph.Core</span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- $setup</span></span><span>
</span><span id="line-17"></span><span>                             </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier">PlaneGraph</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier">graph</span></a></span><span>
</span><span id="line-18"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PlanarGraph</span></span><span>
</span><span id="line-19"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier">VertexData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier">vData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier">location</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier">vtxDataToExt</span></a></span><span>
</span><span id="line-20"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier">fromSimplePolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier">fromConnectedSegments</span></a></span><span>
</span><span id="line-21"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PG.fromAdjacencyLists</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numVertices"><span class="hs-identifier">numVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numEdges"><span class="hs-identifier">numEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numFaces"><span class="hs-identifier">numFaces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier">numDarts</span></a></span><span>
</span><span id="line-24"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dual</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices%27"><span class="hs-identifier">vertices'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier">vertices</span></a></span><span>
</span><span id="line-27"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edges%27"><span class="hs-identifier">edges'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier">edges</span></a></span><span>
</span><span id="line-28"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier">faces'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier">faces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFaces"><span class="hs-identifier">internalFaces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier">faces''</span></a></span><span>
</span><span id="line-29"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#darts%27"><span class="hs-identifier">darts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier">darts</span></a></span><span>
</span><span id="line-30"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseVertices"><span class="hs-identifier">traverseVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseDarts"><span class="hs-identifier">traverseDarts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseFaces"><span class="hs-identifier">traverseFaces</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier">headOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier">tailOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">twin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier">incidentEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#incomingEdges"><span class="hs-identifier">incomingEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outgoingEdges"><span class="hs-identifier">outgoingEdges</span></a></span><span>
</span><span id="line-35"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#neighboursOf"><span class="hs-identifier">neighboursOf</span></a></span><span>
</span><span id="line-36"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier">nextIncidentEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier">prevIncidentEdge</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier">leftFace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier">rightFace</span></a></span><span>
</span><span id="line-40"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#nextEdge"><span class="hs-identifier">nextEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#prevEdge"><span class="hs-identifier">prevEdge</span></a></span><span>
</span><span id="line-41"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier">boundary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier">boundary'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier">boundaryDart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier">boundaryVertices</span></a></span><span>
</span><span id="line-42"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier">outerFaceId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier">outerFaceDart</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier">vertexDataOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#locationOf"><span class="hs-identifier">locationOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasDataOf</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier">endPointsOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier">endPointData</span></a></span><span>
</span><span id="line-47"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier">vertexData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier">faceData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier">dartData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier">rawDartData</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier">edgeSegment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegments"><span class="hs-identifier">edgeSegments</span></a></span><span>
</span><span id="line-50"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rawFacePolygon"><span class="hs-identifier">rawFacePolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rawFaceBoundary"><span class="hs-identifier">rawFaceBoundary</span></a></span><span>
</span><span id="line-51"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#rawFacePolygons"><span class="hs-identifier">rawFacePolygons</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dart</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">World</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId'</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#withEdgeDistances"><span class="hs-identifier">withEdgeDistances</span></a></span><span>
</span><span id="line-57"></span><span>                           </span><span class="hs-comment">-- , writePlaneGraph, readPlaneGraph</span><span>
</span><span id="line-58"></span><span>                           </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">holes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">holesOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CircularSeq</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Box.html"><span class="hs-identifier">Data.Geometry.Box</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Interval.html"><span class="hs-identifier">Data.Geometry.Interval</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Line.html"><span class="hs-identifier">Data.Geometry.Line</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#cmpSlope"><span class="hs-identifier">cmpSlope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#supportingLine"><span class="hs-identifier">supportingLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.LineSegment.html"><span class="hs-identifier">Data.Geometry.LineSegment</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.html#endPoints"><span class="hs-identifier">endPoints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Polygon.html"><span class="hs-identifier">Data.Geometry.Polygon</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Properties.html"><span class="hs-identifier">Data.Geometry.Properties</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">PlanarGraph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">planarGraph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dual</span></span><span>
</span><span id="line-79"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dart</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Arc</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Direction</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">twin</span></span><span>
</span><span id="line-81"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">World</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FaceId'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VertexId'</span></span><span>
</span><span id="line-83"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasDataOf</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                                 </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Util</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Proxy</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.PlaneGraph.AdjRep(Gr(Gr),Face(Face),Vtx(Vtx))</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.PlaneGraph.IO(fromAdjRep)</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.PlanarGraph.Dart(Dart(..),Arc(..))</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- let dart i s = Dart (Arc i) (read s)</span><span>
</span><span id="line-98"></span><span class="hs-comment">--     small :: Gr (Vtx Int String Int) (Face String)</span><span>
</span><span id="line-99"></span><span class="hs-comment">--     small = Gr [ Vtx 0 (Point2 0 0) [ (2,&quot;0-&gt;2&quot;)</span><span>
</span><span id="line-100"></span><span class="hs-comment">--                                     , (1,&quot;0-&gt;1&quot;)</span><span>
</span><span id="line-101"></span><span class="hs-comment">--                                     , (3,&quot;0-&gt;3&quot;)</span><span>
</span><span id="line-102"></span><span class="hs-comment">--                                     ] 0</span><span>
</span><span id="line-103"></span><span class="hs-comment">--                , Vtx 1 (Point2 2 2) [ (0,&quot;1-&gt;0&quot;)</span><span>
</span><span id="line-104"></span><span class="hs-comment">--                                     , (2,&quot;1-&gt;2&quot;)</span><span>
</span><span id="line-105"></span><span class="hs-comment">--                                     , (3,&quot;1-&gt;3&quot;)</span><span>
</span><span id="line-106"></span><span class="hs-comment">--                                     ] 1</span><span>
</span><span id="line-107"></span><span class="hs-comment">--                , Vtx 2 (Point2 2 0) [ (0,&quot;2-&gt;0&quot;)</span><span>
</span><span id="line-108"></span><span class="hs-comment">--                                     , (1,&quot;2-&gt;1&quot;)</span><span>
</span><span id="line-109"></span><span class="hs-comment">--                                     ] 2</span><span>
</span><span id="line-110"></span><span class="hs-comment">--                , Vtx 3 (Point2 (-1) 4) [ (0,&quot;3-&gt;0&quot;)</span><span>
</span><span id="line-111"></span><span class="hs-comment">--                                        , (1,&quot;3-&gt;1&quot;)</span><span>
</span><span id="line-112"></span><span class="hs-comment">--                                        ] 3</span><span>
</span><span id="line-113"></span><span class="hs-comment">--                ]</span><span>
</span><span id="line-114"></span><span class="hs-comment">--                [ Face (2,1) &quot;OuterFace&quot;</span><span>
</span><span id="line-115"></span><span class="hs-comment">--                , Face (0,1) &quot;A&quot;</span><span>
</span><span id="line-116"></span><span class="hs-comment">--                , Face (1,0) &quot;B&quot;</span><span>
</span><span id="line-117"></span><span class="hs-comment">--                ]</span><span>
</span><span id="line-118"></span><span class="hs-comment">--     smallG = fromAdjRep (Proxy :: Proxy ()) small</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- This represents the following graph. Note that the graph is undirected, the</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- arrows are just to indicate what the Positive direction of the darts is.</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- ![myGraph](docs/Data/PlaneGraph/small.png)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- * Vertex Data</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Note that the functor instance is in v</span><span>
</span><span id="line-132"></span><span id="local-6989586621679981008"><span id="local-6989586621679981009"></span></span><span class="hs-keyword">data</span><span> </span><span id="VertexData"><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span></span><span> </span><span id="local-6989586621679981984"><span class="annot"><a href="#local-6989586621679981984"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679981983"><span class="annot"><a href="#local-6989586621679981983"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VertexData"><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_location"><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r
</span><a href="Data.PlaneGraph.Core.html#_location"><span class="hs-identifier hs-var hs-var">_location</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679981984"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span id="_vData"><span class="annot"><span class="annottext">VertexData r v -&gt; v
</span><a href="Data.PlaneGraph.Core.html#_vData"><span class="hs-identifier hs-var hs-var">_vData</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679981983"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-134"></span><span>                                 </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679981000"><span id="local-6989586621679981002"><span id="local-6989586621679981004"><span class="annot"><span class="annottext">Int -&gt; VertexData r v -&gt; ShowS
[VertexData r v] -&gt; ShowS
VertexData r v -&gt; String
(Int -&gt; VertexData r v -&gt; ShowS)
-&gt; (VertexData r v -&gt; String)
-&gt; ([VertexData r v] -&gt; ShowS)
-&gt; Show (VertexData r v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r v. (Show r, Show v) =&gt; Int -&gt; VertexData r v -&gt; ShowS
forall r v. (Show r, Show v) =&gt; [VertexData r v] -&gt; ShowS
forall r v. (Show r, Show v) =&gt; VertexData r v -&gt; String
showList :: [VertexData r v] -&gt; ShowS
$cshowList :: forall r v. (Show r, Show v) =&gt; [VertexData r v] -&gt; ShowS
show :: VertexData r v -&gt; String
$cshow :: forall r v. (Show r, Show v) =&gt; VertexData r v -&gt; String
showsPrec :: Int -&gt; VertexData r v -&gt; ShowS
$cshowsPrec :: forall r v. (Show r, Show v) =&gt; Int -&gt; VertexData r v -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679980995"><span id="local-6989586621679980997"><span class="annot"><span class="annottext">VertexData r v -&gt; VertexData r v -&gt; Bool
(VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; Eq (VertexData r v)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r v.
(Eq r, Eq v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
/= :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c/= :: forall r v.
(Eq r, Eq v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
== :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c== :: forall r v.
(Eq r, Eq v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679980979"><span id="local-6989586621679980981"><span id="local-6989586621679980983"><span id="local-6989586621679980985"><span id="local-6989586621679980987"><span id="local-6989586621679980989"><span id="local-6989586621679980991"><span class="annot"><span class="annottext">Eq (VertexData r v)
Eq (VertexData r v) =&gt;
(VertexData r v -&gt; VertexData r v -&gt; Ordering)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; Bool)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; VertexData r v)
-&gt; (VertexData r v -&gt; VertexData r v -&gt; VertexData r v)
-&gt; Ord (VertexData r v)
VertexData r v -&gt; VertexData r v -&gt; Bool
VertexData r v -&gt; VertexData r v -&gt; Ordering
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall r v. (Ord r, Ord v) =&gt; Eq (VertexData r v)
forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Ordering
forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
min :: VertexData r v -&gt; VertexData r v -&gt; VertexData r v
$cmin :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
max :: VertexData r v -&gt; VertexData r v -&gt; VertexData r v
$cmax :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; VertexData r v
&gt;= :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&gt;= :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
&gt; :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&gt; :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
&lt;= :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&lt;= :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
&lt; :: VertexData r v -&gt; VertexData r v -&gt; Bool
$c&lt; :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Bool
compare :: VertexData r v -&gt; VertexData r v -&gt; Ordering
$ccompare :: forall r v.
(Ord r, Ord v) =&gt;
VertexData r v -&gt; VertexData r v -&gt; Ordering
$cp1Ord :: forall r v. (Ord r, Ord v) =&gt; Eq (VertexData r v)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(forall x. VertexData r v -&gt; Rep (VertexData r v) x)
-&gt; (forall x. Rep (VertexData r v) x -&gt; VertexData r v)
-&gt; Generic (VertexData r v)
forall x. Rep (VertexData r v) x -&gt; VertexData r v
forall x. VertexData r v -&gt; Rep (VertexData r v) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall r v x. Rep (VertexData r v) x -&gt; VertexData r v
forall r v x. VertexData r v -&gt; Rep (VertexData r v) x
$cto :: forall r v x. Rep (VertexData r v) x -&gt; VertexData r v
$cfrom :: forall r v x. VertexData r v -&gt; Rep (VertexData r v) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span>
</span><span id="line-135"></span><span>                                            </span><span class="hs-special">,</span><span id="local-6989586621679980971"><span id="local-6989586621679980973"><span class="annot"><span class="annottext">a -&gt; VertexData r b -&gt; VertexData r a
(a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
(forall a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b)
-&gt; (forall a b. a -&gt; VertexData r b -&gt; VertexData r a)
-&gt; Functor (VertexData r)
forall a b. a -&gt; VertexData r b -&gt; VertexData r a
forall a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
forall r a b. a -&gt; VertexData r b -&gt; VertexData r a
forall r a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; VertexData r b -&gt; VertexData r a
$c&lt;$ :: forall r a b. a -&gt; VertexData r b -&gt; VertexData r a
fmap :: (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
$cfmap :: forall r a b. (a -&gt; b) -&gt; VertexData r a -&gt; VertexData r b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679980936"><span id="local-6989586621679980938"><span id="local-6989586621679980940"><span id="local-6989586621679980942"><span id="local-6989586621679980944"><span id="local-6989586621679980946"><span id="local-6989586621679980948"><span id="local-6989586621679980950"><span id="local-6989586621679980952"><span id="local-6989586621679980954"><span id="local-6989586621679980956"><span id="local-6989586621679980958"><span id="local-6989586621679980960"><span id="local-6989586621679980962"><span id="local-6989586621679980964"><span id="local-6989586621679980966"><span id="local-6989586621679980968"><span class="annot"><span class="annottext">VertexData r a -&gt; Bool
(a -&gt; m) -&gt; VertexData r a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
(forall m. Monoid m =&gt; VertexData r m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a)
-&gt; (forall a. VertexData r a -&gt; [a])
-&gt; (forall a. VertexData r a -&gt; Bool)
-&gt; (forall a. VertexData r a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; VertexData r a -&gt; a)
-&gt; (forall a. Ord a =&gt; VertexData r a -&gt; a)
-&gt; (forall a. Num a =&gt; VertexData r a -&gt; a)
-&gt; (forall a. Num a =&gt; VertexData r a -&gt; a)
-&gt; Foldable (VertexData r)
forall a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool
forall a. Num a =&gt; VertexData r a -&gt; a
forall a. Ord a =&gt; VertexData r a -&gt; a
forall m. Monoid m =&gt; VertexData r m -&gt; m
forall a. VertexData r a -&gt; Bool
forall a. VertexData r a -&gt; Int
forall a. VertexData r a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
forall r a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool
forall r a. Num a =&gt; VertexData r a -&gt; a
forall r a. Ord a =&gt; VertexData r a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
forall r m. Monoid m =&gt; VertexData r m -&gt; m
forall r a. VertexData r a -&gt; Bool
forall r a. VertexData r a -&gt; Int
forall r a. VertexData r a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall r a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
forall r m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
forall r b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall r a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: VertexData r a -&gt; a
$cproduct :: forall r a. Num a =&gt; VertexData r a -&gt; a
sum :: VertexData r a -&gt; a
$csum :: forall r a. Num a =&gt; VertexData r a -&gt; a
minimum :: VertexData r a -&gt; a
$cminimum :: forall r a. Ord a =&gt; VertexData r a -&gt; a
maximum :: VertexData r a -&gt; a
$cmaximum :: forall r a. Ord a =&gt; VertexData r a -&gt; a
elem :: a -&gt; VertexData r a -&gt; Bool
$celem :: forall r a. Eq a =&gt; a -&gt; VertexData r a -&gt; Bool
length :: VertexData r a -&gt; Int
$clength :: forall r a. VertexData r a -&gt; Int
null :: VertexData r a -&gt; Bool
$cnull :: forall r a. VertexData r a -&gt; Bool
toList :: VertexData r a -&gt; [a]
$ctoList :: forall r a. VertexData r a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
$cfoldl1 :: forall r a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
$cfoldr1 :: forall r a. (a -&gt; a -&gt; a) -&gt; VertexData r a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldl' :: forall r b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldl :: forall r b a. (b -&gt; a -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldr' :: forall r a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
$cfoldr :: forall r a b. (a -&gt; b -&gt; b) -&gt; b -&gt; VertexData r a -&gt; b
foldMap' :: (a -&gt; m) -&gt; VertexData r a -&gt; m
$cfoldMap' :: forall r m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
foldMap :: (a -&gt; m) -&gt; VertexData r a -&gt; m
$cfoldMap :: forall r m a. Monoid m =&gt; (a -&gt; m) -&gt; VertexData r a -&gt; m
fold :: VertexData r m -&gt; m
$cfold :: forall r m. Monoid m =&gt; VertexData r m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679980925"><span id="local-6989586621679980927"><span id="local-6989586621679980929"><span id="local-6989586621679980931"><span class="annot"><span class="annottext">Functor (VertexData r)
Foldable (VertexData r)
(Functor (VertexData r), Foldable (VertexData r)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    VertexData r (f a) -&gt; f (VertexData r a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    VertexData r (m a) -&gt; m (VertexData r a))
-&gt; Traversable (VertexData r)
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
forall r. Functor (VertexData r)
forall r. Foldable (VertexData r)
forall r (m :: * -&gt; *) a.
Monad m =&gt;
VertexData r (m a) -&gt; m (VertexData r a)
forall r (f :: * -&gt; *) a.
Applicative f =&gt;
VertexData r (f a) -&gt; f (VertexData r a)
forall r (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
forall r (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
VertexData r (m a) -&gt; m (VertexData r a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
VertexData r (f a) -&gt; f (VertexData r a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
sequence :: VertexData r (m a) -&gt; m (VertexData r a)
$csequence :: forall r (m :: * -&gt; *) a.
Monad m =&gt;
VertexData r (m a) -&gt; m (VertexData r a)
mapM :: (a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
$cmapM :: forall r (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; VertexData r a -&gt; m (VertexData r b)
sequenceA :: VertexData r (f a) -&gt; f (VertexData r a)
$csequenceA :: forall r (f :: * -&gt; *) a.
Applicative f =&gt;
VertexData r (f a) -&gt; f (VertexData r a)
traverse :: (a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
$ctraverse :: forall r (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; VertexData r a -&gt; f (VertexData r b)
$cp2Traversable :: forall r. Foldable (VertexData r)
$cp1Traversable :: forall r. Functor (VertexData r)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span id="location"><span id="vData"><span id="local-6989586621679981592"><span id="local-6989586621679981888"><span id="local-6989586621679981983"><span id="local-6989586621679981984"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">VertexData</span></span></span></span></span></span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679981967"><span id="local-6989586621679981968"><span class="annot"><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-type">vtxDataToExt</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981968"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981967"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679981968"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679981967"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-139"></span><span id="vtxDataToExt"><span class="annot"><span class="annottext">vtxDataToExt :: VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var hs-var">vtxDataToExt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span id="local-6989586621679980923"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679980923"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679980922"><span class="annot"><span class="annottext">v :: v
</span><a href="#local-6989586621679980922"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980923"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; v -&gt; Point 2 r :+ v
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679980922"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679980916"><span id="local-6989586621679980918"><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679980914"><span class="annot"><span class="annottext">bimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; VertexData a c -&gt; VertexData b d
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bimap</span></span></span><span> </span><span id="local-6989586621679980912"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679980912"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679980911"><span class="annot"><span class="annottext">g :: c -&gt; d
</span><a href="#local-6989586621679980911"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span id="local-6989586621679980910"><span class="annot"><span class="annottext">p :: Point 2 a
</span><a href="#local-6989586621679980910"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679980909"><span class="annot"><span class="annottext">v :: c
</span><a href="#local-6989586621679980909"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 b -&gt; d -&gt; VertexData b d
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Point 2 a -&gt; Point 2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679980912"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 a
</span><a href="#local-6989586621679980910"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679980911"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679980909"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679980907"><span id="local-6989586621679980908"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679980904"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679980908"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679980907"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980908"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980907"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679980902"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (VertexData r v)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; VertexData r v)
-&gt; Parser (Point 2 r :+ v) -&gt; Parser (VertexData r v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679980900"><span class="annot"><span class="annottext">l :: Point 2 r
</span><a href="#local-6989586621679980900"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621679980899"><span class="annot"><span class="annottext">d :: v
</span><a href="#local-6989586621679980899"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; v -&gt; VertexData r v
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980900"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679980899"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser (Point 2 r :+ v) -&gt; Parser (VertexData r v))
-&gt; (Value -&gt; Parser (Point 2 r :+ v))
-&gt; Value
-&gt; Parser (VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Point 2 r :+ v)
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span></span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679980896"><span id="local-6989586621679980897"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679980890"><span id="local-6989586621679980892"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679980897"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679980896"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980897"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980896"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679980888"><span class="annot"><span class="annottext">toJSON :: VertexData r v -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span>     </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; Value)
-&gt; (VertexData r v -&gt; Point 2 r :+ v) -&gt; VertexData r v -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679980886"><span class="annot"><span class="annottext">toEncoding :: VertexData r v -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ v) -&gt; Encoding)
-&gt; (VertexData r v -&gt; Point 2 r :+ v) -&gt; VertexData r v -&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span></span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- * The PlaneGraph type</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Embedded, *connected*, planar graph</span><span>
</span><span id="line-155"></span><span id="local-6989586621679980883"><span id="local-6989586621679980884"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PlaneGraph"><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span></span><span> </span><span id="local-6989586621679981909"><span class="annot"><a href="#local-6989586621679981909"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679981908"><span class="annot"><a href="#local-6989586621679981908"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679981907"><span class="annot"><a href="#local-6989586621679981907"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679981906"><span class="annot"><a href="#local-6989586621679981906"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679981905"><span class="annot"><a href="#local-6989586621679981905"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>    </span><span id="PlaneGraph"><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_graph"><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlanarGraph</span></span><span> </span><span class="annot"><a href="#local-6989586621679981909"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Primal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981905"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981908"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679981907"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981906"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980876"><span id="local-6989586621679980878"><span id="local-6989586621679980880"><span class="annot"><span class="annottext">Int -&gt; PlaneGraph s v e f r -&gt; ShowS
[PlaneGraph s v e f r] -&gt; ShowS
PlaneGraph s v e f r -&gt; String
(Int -&gt; PlaneGraph s v e f r -&gt; ShowS)
-&gt; (PlaneGraph s v e f r -&gt; String)
-&gt; ([PlaneGraph s v e f r] -&gt; ShowS)
-&gt; Show (PlaneGraph s v e f r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
Int -&gt; PlaneGraph s v e f r -&gt; ShowS
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
[PlaneGraph s v e f r] -&gt; ShowS
forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
PlaneGraph s v e f r -&gt; String
showList :: [PlaneGraph s v e f r] -&gt; ShowS
$cshowList :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
[PlaneGraph s v e f r] -&gt; ShowS
show :: PlaneGraph s v e f r -&gt; String
$cshow :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
PlaneGraph s v e f r -&gt; String
showsPrec :: Int -&gt; PlaneGraph s v e f r -&gt; ShowS
$cshowsPrec :: forall k (s :: k) v e f r.
(Show r, Show v, Show e, Show f) =&gt;
Int -&gt; PlaneGraph s v e f r -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679980872"><span id="local-6989586621679980874"><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
(PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool)
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool)
-&gt; Eq (PlaneGraph s v e f r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
/= :: PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
$c/= :: forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
== :: PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
$c== :: forall k (s :: k) v e f r.
(Eq r, Eq v, Eq e, Eq f) =&gt;
PlaneGraph s v e f r -&gt; PlaneGraph s v e f r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(forall x. PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x)
-&gt; (forall x. Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r)
-&gt; Generic (PlaneGraph s v e f r)
forall x. Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r
forall x. PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall k (s :: k) v e f r x.
Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r
forall k (s :: k) v e f r x.
PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x
$cto :: forall k (s :: k) v e f r x.
Rep (PlaneGraph s v e f r) x -&gt; PlaneGraph s v e f r
$cfrom :: forall k (s :: k) v e f r x.
PlaneGraph s v e f r -&gt; Rep (PlaneGraph s v e f r) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span id="graph"><span id="local-6989586621679981900"><span id="local-6989586621679981901"><span id="local-6989586621679981902"><span id="local-6989586621679981903"><span id="local-6989586621679981904"><span id="local-6989586621679981905"><span id="local-6989586621679981906"><span id="local-6989586621679981907"><span id="local-6989586621679981908"><span id="local-6989586621679981909"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PlaneGraph</span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><a href="Data.Geometry.Properties.html#NumType"><span class="hs-identifier hs-var">NumType</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span id="local-6989586621679980869"><span class="annot"><a href="#local-6989586621679980869"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679980868"><span class="annot"><a href="#local-6989586621679980868"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679980867"><span class="annot"><a href="#local-6989586621679980867"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679980866"><span class="annot"><a href="#local-6989586621679980866"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679980865"><span class="annot"><a href="#local-6989586621679980865"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679980865"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-161"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><a href="Data.Geometry.Properties.html#Dimension"><span class="hs-identifier hs-var">Dimension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span id="local-6989586621679980864"><span class="annot"><a href="#local-6989586621679980864"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679980863"><span class="annot"><a href="#local-6989586621679980863"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679980862"><span class="annot"><a href="#local-6989586621679980862"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679980861"><span class="annot"><a href="#local-6989586621679980861"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679980860"><span class="annot"><a href="#local-6989586621679980860"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679980856"><span id="local-6989586621679980857"><span id="local-6989586621679980858"><span id="local-6989586621679980859"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679980853"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980859"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980858"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980857"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980856"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679980852"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; PlaneGraph s v e f a -&gt; PlaneGraph s v e f b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679980851"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679980851"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679980850"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f a
</span><a href="#local-6989586621679980850"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f a
</span><a href="#local-6989586621679980850"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f a
-&gt; (PlaneGraph s v e f a -&gt; PlaneGraph s v e f b)
-&gt; PlaneGraph s v e f b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData a v) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
-&gt; PlaneGraph s v e f a -&gt; Identity (PlaneGraph s v e f b)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData a v) e f
  -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
 -&gt; PlaneGraph s v e f a -&gt; Identity (PlaneGraph s v e f b))
-&gt; ((Point 2 a -&gt; Identity (Point 2 b))
    -&gt; PlanarGraph s 'Primal (VertexData a v) e f
    -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
-&gt; (Point 2 a -&gt; Identity (Point 2 b))
-&gt; PlaneGraph s v e f a
-&gt; Identity (PlaneGraph s v e f b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
-&gt; PlanarGraph s 'Primal (VertexData a v) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f)
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span class="annot"><span class="annottext">((Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
 -&gt; PlanarGraph s 'Primal (VertexData a v) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f))
-&gt; ((Point 2 a -&gt; Identity (Point 2 b))
    -&gt; Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
-&gt; (Point 2 a -&gt; Identity (Point 2 b))
-&gt; PlanarGraph s 'Primal (VertexData a v) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData b v) e f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexData a v -&gt; Identity (VertexData b v))
-&gt; Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((VertexData a v -&gt; Identity (VertexData b v))
 -&gt; Vector (VertexData a v) -&gt; Identity (Vector (VertexData b v)))
-&gt; ((Point 2 a -&gt; Identity (Point 2 b))
    -&gt; VertexData a v -&gt; Identity (VertexData b v))
-&gt; (Point 2 a -&gt; Identity (Point 2 b))
-&gt; Vector (VertexData a v)
-&gt; Identity (Vector (VertexData b v))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 a -&gt; Identity (Point 2 b))
-&gt; VertexData a v -&gt; Identity (VertexData b v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">((Point 2 a -&gt; Identity (Point 2 b))
 -&gt; PlaneGraph s v e f a -&gt; Identity (PlaneGraph s v e f b))
-&gt; (Point 2 a -&gt; Point 2 b)
-&gt; PlaneGraph s v e f a
-&gt; PlaneGraph s v e f b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Point 2 a -&gt; Point 2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679980851"><span class="hs-identifier hs-var">f</span></a></span></span></span></span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679980841"><span id="local-6989586621679980842"><span id="local-6989586621679980843"><span id="local-6989586621679980844"><span id="local-6989586621679980845"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#IsBoxable"><span class="hs-identifier hs-type">IsBoxable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980845"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980844"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980843"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980842"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980841"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679980838"><span class="annot"><span class="annottext">boundingBox :: PlaneGraph s v e f r
-&gt; Box
     (Dimension (PlaneGraph s v e f r))
     ()
     (NumType (PlaneGraph s v e f r))
</span><a href="Data.Geometry.Box.Internal.html#boundingBox"><span class="hs-identifier hs-var hs-var hs-var hs-var">boundingBox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; Box 2 () r
forall g (c :: * -&gt; *).
(IsBoxable g, Foldable c, Ord (NumType g), Arity (Dimension g)) =&gt;
c g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Data.Geometry.Box.Internal.html#boundingBoxList%27"><span class="hs-identifier hs-var">boundingBoxList'</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; Box 2 () r)
-&gt; (PlaneGraph s v e f r -&gt; [Point 2 r])
-&gt; PlaneGraph s v e f r
-&gt; Box 2 () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point 2 r) -&gt; [Point 2 r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Point 2 r) -&gt; [Point 2 r])
-&gt; (PlaneGraph s v e f r -&gt; Vector (Point 2 r))
-&gt; PlaneGraph s v e f r
-&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((VertexId' s, VertexData r v) -&gt; Point 2 r)
-&gt; Vector (VertexId' s, VertexData r v) -&gt; Vector (Point 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VertexId' s, VertexData r v)
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; (VertexId' s, VertexData r v)
-&gt; Const (Point 2 r) (VertexId' s, VertexData r v)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="annot"><span class="annottext">((VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
 -&gt; (VertexId' s, VertexData r v)
 -&gt; Const (Point 2 r) (VertexId' s, VertexData r v))
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s, VertexData r v) -&gt; Vector (Point 2 r))
-&gt; (PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span></span></span></span></span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- * Constructing a Plane Graph</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Construct a plane graph from a simple polygon. It is assumed that the</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- polygon is given in counterclockwise order.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- the interior of the polygon will have faceId 0</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- pre: the input polygon is given in counterclockwise order</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- running time: \(O(n)\).</span><span>
</span><span id="line-180"></span><span id="local-6989586621679980828"><span id="local-6989586621679980829"><span id="local-6989586621679980830"><span id="local-6989586621679980831"><span id="local-6989586621679980832"><span class="annot"><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier hs-type">fromSimplePolygon</span></a></span><span>                            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679980832"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980831"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-181"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980830"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980829"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-182"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980828"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-comment">-- ^ data inside</span><span>
</span><span id="line-183"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980828"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-comment">-- ^ data outside the polygon</span><span>
</span><span id="line-184"></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980831"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980830"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679980828"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980829"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-185"></span><span id="fromSimplePolygon"><span class="annot"><span class="annottext">fromSimplePolygon :: proxy s -&gt; SimplePolygon p r -&gt; f -&gt; f -&gt; PlaneGraph s p () f r
</span><a href="Data.PlaneGraph.Core.html#fromSimplePolygon"><span class="hs-identifier hs-var hs-var">fromSimplePolygon</span></a></span></span><span> </span><span id="local-6989586621679980827"><span class="annot"><span class="annottext">p :: proxy s
</span><a href="#local-6989586621679980827"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span id="local-6989586621679980825"><span class="annot"><span class="annottext">vs :: CSeq (Point 2 r :+ p)
</span><a href="#local-6989586621679980825"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679980824"><span class="annot"><span class="annottext">iD :: f
</span><a href="#local-6989586621679980824"><span class="hs-identifier hs-var">iD</span></a></span></span><span> </span><span id="local-6989586621679980823"><span class="annot"><span class="annottext">oD :: f
</span><a href="#local-6989586621679980823"><span class="hs-identifier hs-var">oD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () f
-&gt; PlaneGraph s p () f r
forall k (s :: k) v e f r.
PlanarGraph s 'Primal (VertexData r v) e f -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () f
</span><a href="#local-6989586621679980822"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679980821"><span class="annot"><span class="annottext">g :: PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="#local-6989586621679980821"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy s
-&gt; CSeq (Point 2 r :+ p)
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
forall k (proxy :: k -&gt; *) (s :: k) r p.
proxy s
-&gt; CSeq (Point 2 r :+ p)
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="Data.PlaneGraph.Core.html#fromVertices"><span class="hs-identifier hs-var">fromVertices</span></a></span><span> </span><span class="annot"><span class="annottext">proxy s
</span><a href="#local-6989586621679980827"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">CSeq (Point 2 r :+ p)
</span><a href="#local-6989586621679980825"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679980819"><span class="annot"><span class="annottext">fData' :: Vector f
</span><a href="#local-6989586621679980819"><span class="hs-identifier hs-var hs-var">fData'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[f] -&gt; Vector f
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679980824"><span class="hs-identifier hs-var">iD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679980823"><span class="hs-identifier hs-var">oD</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679980822"><span class="annot"><span class="annottext">g' :: PlanarGraph s 'Primal (VertexData r p) () f
</span><a href="#local-6989586621679980822"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="#local-6989586621679980821"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r p) () ()
-&gt; (PlanarGraph s 'Primal (VertexData r p) () ()
    -&gt; PlanarGraph s 'Primal (VertexData r p) () f)
-&gt; PlanarGraph s 'Primal (VertexData r p) () f
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector () -&gt; Identity (Vector f))
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
-&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () f)
forall k (s :: k) (w :: World) v e f f'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e f')
  (Vector f)
  (Vector f')
</span><span class="hs-identifier hs-var">PG.faceData</span></span><span> </span><span class="annot"><span class="annottext">((Vector () -&gt; Identity (Vector f))
 -&gt; PlanarGraph s 'Primal (VertexData r p) () ()
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () f))
-&gt; Vector f
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
-&gt; PlanarGraph s 'Primal (VertexData r p) () f
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector f
</span><a href="#local-6989586621679980819"><span class="hs-identifier hs-var">fData'</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Constructs a planar from the given vertices</span><span>
</span><span id="line-192"></span><span id="local-6989586621679981839"><span id="local-6989586621679981840"><span id="local-6989586621679981841"><span id="local-6989586621679981842"><span class="annot"><a href="Data.PlaneGraph.Core.html#fromVertices"><span class="hs-identifier hs-type">fromVertices</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679981842"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981841"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-193"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.CSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679981840"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679981839"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlanarGraph</span></span><span> </span><span class="annot"><a href="#local-6989586621679981841"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Primal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981840"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981839"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-195"></span><span id="fromVertices"><span class="annot"><span class="annottext">fromVertices :: proxy s
-&gt; CSeq (Point 2 r :+ p)
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
</span><a href="Data.PlaneGraph.Core.html#fromVertices"><span class="hs-identifier hs-var hs-var">fromVertices</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679980815"><span class="annot"><span class="annottext">vs :: CSeq (Point 2 r :+ p)
</span><a href="#local-6989586621679980815"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal () () ()
</span><a href="#local-6989586621679980814"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlanarGraph s 'Primal () () ()
-&gt; (PlanarGraph s 'Primal () () ()
    -&gt; PlanarGraph s 'Primal (VertexData r p) () ())
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector () -&gt; Identity (Vector (VertexData r p)))
-&gt; PlanarGraph s 'Primal () () ()
-&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () ())
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="annot"><span class="annottext">((Vector () -&gt; Identity (Vector (VertexData r p)))
 -&gt; PlanarGraph s 'Primal () () ()
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) () ()))
-&gt; Vector (VertexData r p)
-&gt; PlanarGraph s 'Primal () () ()
-&gt; PlanarGraph s 'Primal (VertexData r p) () ()
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexData r p)
</span><a href="#local-6989586621679980813"><span class="hs-identifier hs-var">vData'</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679980812"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679980812"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSeq (Point 2 r :+ p) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">CSeq (Point 2 r :+ p)
</span><a href="#local-6989586621679980815"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679980814"><span class="annot"><span class="annottext">g :: PlanarGraph s 'Primal () () ()
</span><a href="#local-6989586621679980814"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Dart s, ())]] -&gt; PlanarGraph s 'Primal () () ()
forall k (s :: k) e.
[[(Dart s, e)]] -&gt; PlanarGraph s 'Primal () e ()
</span><span class="hs-identifier hs-var">planarGraph</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679980808"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>               </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Arc s) -&gt; Int -&gt; Arc s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679980808"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679980812"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Negative</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679980808"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679980808"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679980812"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679980813"><span class="annot"><span class="annottext">vData' :: Vector (VertexData r p)
</span><a href="#local-6989586621679980813"><span class="hs-identifier hs-var hs-var">vData'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VertexData r p] -&gt; Vector (VertexData r p)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([VertexData r p] -&gt; Vector (VertexData r p))
-&gt; (CSeq (Point 2 r :+ p) -&gt; [VertexData r p])
-&gt; CSeq (Point 2 r :+ p)
-&gt; Vector (VertexData r p)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ p) -&gt; VertexData r p)
-&gt; [Point 2 r :+ p] -&gt; [VertexData r p]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679980803"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679980803"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621679980802"><span class="annot"><span class="annottext">e :: p
</span><a href="#local-6989586621679980802"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; p -&gt; VertexData r p
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980803"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679980802"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ p] -&gt; [VertexData r p])
-&gt; (CSeq (Point 2 r :+ p) -&gt; [Point 2 r :+ p])
-&gt; CSeq (Point 2 r :+ p)
-&gt; [VertexData r p]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CSeq (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(CSeq (Point 2 r :+ p) -&gt; Vector (VertexData r p))
-&gt; CSeq (Point 2 r :+ p) -&gt; Vector (VertexData r p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CSeq (Point 2 r :+ p)
</span><a href="#local-6989586621679980815"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Constructs a connected plane graph</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- pre: The segments form a single connected component</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- running time: \(O(n\log n)\)</span><span>
</span><span id="line-209"></span><span id="local-6989586621679980796"><span id="local-6989586621679980797"><span id="local-6989586621679980798"><span id="local-6989586621679980799"><span id="local-6989586621679980800"><span id="local-6989586621679980801"><span class="annot"><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier hs-type">fromConnectedSegments</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679980801"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679980800"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679980800"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980799"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980798"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-211"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980801"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679980797"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980800"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679980796"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980798"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty.NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679980797"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679980796"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679980800"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-213"></span><span id="fromConnectedSegments"><span class="annot"><span class="annottext">fromConnectedSegments :: proxy s
-&gt; f (LineSegment 2 p r :+ e) -&gt; PlaneGraph s (NonEmpty p) e () r
</span><a href="Data.PlaneGraph.Core.html#fromConnectedSegments"><span class="hs-identifier hs-var hs-var">fromConnectedSegments</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679980795"><span class="annot"><span class="annottext">ss :: f (LineSegment 2 p r :+ e)
</span><a href="#local-6989586621679980795"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
-&gt; PlaneGraph s (NonEmpty p) e () r
forall k (s :: k) v e f r.
PlanarGraph s 'Primal (VertexData r v) e f -&gt; PlaneGraph s v e f r
</span><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-var">PlaneGraph</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
 -&gt; PlaneGraph s (NonEmpty p) e () r)
-&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
-&gt; PlaneGraph s (NonEmpty p) e () r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Dart s, e)]] -&gt; PlanarGraph s 'Primal () e ()
forall k (s :: k) e.
[[(Dart s, e)]] -&gt; PlanarGraph s 'Primal () e ()
</span><span class="hs-identifier hs-var">planarGraph</span></span><span> </span><span class="annot"><span class="annottext">[[(Dart s, e)]]
</span><a href="#local-6989586621679980794"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal () e ()
-&gt; (PlanarGraph s 'Primal () e ()
    -&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ())
-&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector () -&gt; Identity (Vector (VertexData r (NonEmpty p))))
-&gt; PlanarGraph s 'Primal () e ()
-&gt; Identity
     (PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ())
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="annot"><span class="annottext">((Vector () -&gt; Identity (Vector (VertexData r (NonEmpty p))))
 -&gt; PlanarGraph s 'Primal () e ()
 -&gt; Identity
      (PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()))
-&gt; Vector (VertexData r (NonEmpty p))
-&gt; PlanarGraph s 'Primal () e ()
-&gt; PlanarGraph s 'Primal (VertexData r (NonEmpty p)) e ()
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexData r (NonEmpty p))
</span><a href="#local-6989586621679980793"><span class="hs-identifier hs-var">vxData</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679980792"><span class="annot"><span class="annottext">pts :: Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
</span><a href="#local-6989586621679980792"><span class="hs-identifier hs-var hs-var">pts</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
 -&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
 -&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
-&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
-&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
 -&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]))
-&gt; (f (LineSegment 2 p r :+ e)
    -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; f (LineSegment 2 p r :+ e)
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((LineSegment 2 p r :+ (Arc s :+ e))
 -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; [LineSegment 2 p r :+ (Arc s :+ e)]
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 p r :+ (Arc s :+ e))
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall k s (s :: k) b.
(HasStart s, HasEnd s, StartExtra s ~ EndExtra s,
 EndCore s ~ StartCore s) =&gt;
(s :+ (Arc s :+ b))
-&gt; [(StartCore s,
     SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)])]
</span><a href="#local-6989586621679980789"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 p r :+ (Arc s :+ e)]
 -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; (f (LineSegment 2 p r :+ e)
    -&gt; [LineSegment 2 p r :+ (Arc s :+ e)])
-&gt; f (LineSegment 2 p r :+ e)
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; (LineSegment 2 p r :+ e) -&gt; LineSegment 2 p r :+ (Arc s :+ e))
-&gt; [Int]
-&gt; [LineSegment 2 p r :+ e]
-&gt; [LineSegment 2 p r :+ (Arc s :+ e)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (LineSegment 2 p r :+ e) -&gt; LineSegment 2 p r :+ (Arc s :+ e)
forall k core extra (s :: k).
Int -&gt; (core :+ extra) -&gt; core :+ (Arc s :+ extra)
</span><a href="#local-6989586621679980787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 p r :+ e] -&gt; [LineSegment 2 p r :+ (Arc s :+ e)])
-&gt; (f (LineSegment 2 p r :+ e) -&gt; [LineSegment 2 p r :+ e])
-&gt; f (LineSegment 2 p r :+ e)
-&gt; [LineSegment 2 p r :+ (Arc s :+ e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f (LineSegment 2 p r :+ e) -&gt; [LineSegment 2 p r :+ e]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(f (LineSegment 2 p r :+ e)
 -&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]))
-&gt; f (LineSegment 2 p r :+ e)
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (LineSegment 2 p r :+ e)
</span><a href="#local-6989586621679980795"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679980789"><span class="annot"><span class="annottext">f :: (s :+ (Arc s :+ b))
-&gt; [(StartCore s,
     SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)])]
</span><a href="#local-6989586621679980789"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980786"><span class="annot"><span class="annottext">s :: s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621679980785"><span class="annot"><span class="annottext">e :: Arc s :+ b
</span><a href="#local-6989586621679980785"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasStart t =&gt; Lens' t (StartCore t :+ StartExtra t)
</span><a href="Data.Geometry.Interval.html#start"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span>
</span><span id="line-217"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty (EndExtra s)
-&gt; [StartCore s :+ (Dart s, b)]
-&gt; SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)]
forall a b. a -&gt; b -&gt; SP a b
</span><span class="hs-identifier hs-var">SP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndExtra s -&gt; NonEmpty (EndExtra s)
forall a. a -&gt; NonEmpty a
</span><a href="#local-6989586621679980781"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="annot"><span class="annottext">(EndExtra s -&gt; NonEmpty (EndExtra s))
-&gt; EndExtra s -&gt; NonEmpty (EndExtra s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (EndExtra s) s (EndExtra s) -&gt; EndExtra s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (EndExtra s) s
forall t. HasStart t =&gt; Lens' t (StartCore t :+ StartExtra t)
</span><a href="Data.Geometry.Interval.html#start"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (EndExtra s) s)
-&gt; ((EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; Getting (EndExtra s) s (EndExtra s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (EndExtra s) (StartCore s :+ EndExtra s)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasEnd t =&gt; Lens' t (EndCore t :+ EndExtra t)
</span><a href="Data.Geometry.Interval.html#end"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">StartCore s -&gt; (Dart s, b) -&gt; StartCore s :+ (Dart s, b)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
forall k (s :: k) b. Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
</span><a href="#local-6989586621679980778"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Positive</span></span><span> </span><span class="annot"><span class="annottext">Arc s :+ b
</span><a href="#local-6989586621679980785"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasEnd t =&gt; Lens' t (EndCore t :+ EndExtra t)
</span><a href="Data.Geometry.Interval.html#end"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span>
</span><span id="line-219"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty (EndExtra s)
-&gt; [StartCore s :+ (Dart s, b)]
-&gt; SP (NonEmpty (EndExtra s)) [StartCore s :+ (Dart s, b)]
forall a b. a -&gt; b -&gt; SP a b
</span><span class="hs-identifier hs-var">SP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndExtra s -&gt; NonEmpty (EndExtra s)
forall a. a -&gt; NonEmpty a
</span><a href="#local-6989586621679980781"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="annot"><span class="annottext">(EndExtra s -&gt; NonEmpty (EndExtra s))
-&gt; EndExtra s -&gt; NonEmpty (EndExtra s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (EndExtra s) s (EndExtra s) -&gt; EndExtra s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (EndExtra s) s
forall t. HasEnd t =&gt; Lens' t (EndCore t :+ EndExtra t)
</span><a href="Data.Geometry.Interval.html#end"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (EndExtra s) s)
-&gt; ((EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (EndExtra s) (StartCore s :+ EndExtra s))
-&gt; Getting (EndExtra s) s (EndExtra s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(EndExtra s -&gt; Const (EndExtra s) (EndExtra s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (EndExtra s) (StartCore s :+ EndExtra s)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679980786"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (StartCore s) s (StartCore s) -&gt; StartCore s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">((StartCore s :+ EndExtra s)
 -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; s -&gt; Const (StartCore s) s
forall t. HasStart t =&gt; Lens' t (StartCore t :+ StartExtra t)
</span><a href="Data.Geometry.Interval.html#start"><span class="hs-identifier hs-var">start</span></a></span><span class="annot"><span class="annottext">(((StartCore s :+ EndExtra s)
  -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
 -&gt; s -&gt; Const (StartCore s) s)
-&gt; ((StartCore s -&gt; Const (StartCore s) (StartCore s))
    -&gt; (StartCore s :+ EndExtra s)
    -&gt; Const (StartCore s) (StartCore s :+ EndExtra s))
-&gt; Getting (StartCore s) s (StartCore s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(StartCore s -&gt; Const (StartCore s) (StartCore s))
-&gt; (StartCore s :+ EndExtra s)
-&gt; Const (StartCore s) (StartCore s :+ EndExtra s)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StartCore s -&gt; (Dart s, b) -&gt; StartCore s :+ (Dart s, b)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
forall k (s :: k) b. Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
</span><a href="#local-6989586621679980778"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier hs-var">Negative</span></span><span> </span><span class="annot"><span class="annottext">Arc s :+ b
</span><a href="#local-6989586621679980785"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679980787"><span class="annot"><span class="annottext">g :: Int -&gt; (core :+ extra) -&gt; core :+ (Arc s :+ extra)
</span><a href="#local-6989586621679980787"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679980777"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679980777"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980776"><span class="annot"><span class="annottext">s :: core
</span><a href="#local-6989586621679980776"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621679980775"><span class="annot"><span class="annottext">e :: extra
</span><a href="#local-6989586621679980775"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">core
</span><a href="#local-6989586621679980776"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">core -&gt; (Arc s :+ extra) -&gt; core :+ (Arc s :+ extra)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679980777"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Arc s -&gt; extra -&gt; Arc s :+ extra
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">extra
</span><a href="#local-6989586621679980775"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679980778"><span class="annot"><span class="annottext">h :: Direction -&gt; (Arc s :+ b) -&gt; (Dart s, b)
</span><a href="#local-6989586621679980778"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679980774"><span class="annot"><span class="annottext">d :: Direction
</span><a href="#local-6989586621679980774"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980773"><span class="annot"><span class="annottext">a :: Arc s
</span><a href="#local-6989586621679980773"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span id="local-6989586621679980772"><span class="annot"><span class="annottext">e :: b
</span><a href="#local-6989586621679980772"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="annot"><span class="annottext">Arc s
</span><a href="#local-6989586621679980773"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679980774"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679980772"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679980781"><span class="annot"><span class="annottext">sing :: a -&gt; NonEmpty a
</span><a href="#local-6989586621679980781"><span class="hs-identifier hs-var hs-var">sing</span></a></span></span><span> </span><span id="local-6989586621679980771"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679980771"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679980771"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; NonEmpty a
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679980769"><span class="annot"><span class="annottext">vts :: [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
</span><a href="#local-6989586621679980769"><span class="hs-identifier hs-var hs-var">vts</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
 -&gt; (Point 2 r, SP (NonEmpty p) [(Dart s, e)]))
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679980768"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679980768"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679980767"><span class="annot"><span class="annottext">sp :: SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
</span><a href="#local-6989586621679980767"><span class="hs-identifier hs-var">sp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980768"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">((Point 2 r :+ (Dart s, e)) -&gt; (Dart s, e))
-&gt; [Point 2 r :+ (Dart s, e)] -&gt; [(Dart s, e)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r :+ (Dart s, e))
-&gt; Getting (Dart s, e) (Point 2 r :+ (Dart s, e)) (Dart s, e)
-&gt; (Dart s, e)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Dart s, e) (Point 2 r :+ (Dart s, e)) (Dart s, e)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ (Dart s, e)] -&gt; [(Dart s, e)])
-&gt; ([Point 2 r :+ (Dart s, e)] -&gt; [Point 2 r :+ (Dart s, e)])
-&gt; [Point 2 r :+ (Dart s, e)]
-&gt; [(Dart s, e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ ())
-&gt; [Point 2 r :+ (Dart s, e)] -&gt; [Point 2 r :+ (Dart s, e)]
forall r q p.
(Ord r, Num r) =&gt;
(Point 2 r :+ q) -&gt; [Point 2 r :+ p] -&gt; [Point 2 r :+ p]
</span><a href="Data.Geometry.Point.Orientation.Degenerate.html#sortAround"><span class="hs-identifier hs-var">sortAround</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980768"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ (Dart s, e)] -&gt; [(Dart s, e)])
-&gt; SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
-&gt; SP (NonEmpty p) [(Dart s, e)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">SP (NonEmpty p) [Point 2 r :+ (Dart s, e)]
</span><a href="#local-6989586621679980767"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>           </span><span class="annot"><span class="annottext">([(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
 -&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])])
-&gt; (Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
    -&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])])
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.assocs</span></span><span> </span><span class="annot"><span class="annottext">(Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
 -&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])])
-&gt; Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Point 2 r) (SP (NonEmpty p) [Point 2 r :+ (Dart s, e)])
</span><a href="#local-6989586621679980792"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- vertex Data</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679980793"><span class="annot"><span class="annottext">vxData :: Vector (VertexData r (NonEmpty p))
</span><a href="#local-6989586621679980793"><span class="hs-identifier hs-var hs-var">vxData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VertexData r (NonEmpty p)] -&gt; Vector (VertexData r (NonEmpty p))
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([VertexData r (NonEmpty p)] -&gt; Vector (VertexData r (NonEmpty p)))
-&gt; ([(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
    -&gt; [VertexData r (NonEmpty p)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
-&gt; Vector (VertexData r (NonEmpty p))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, SP (NonEmpty p) [(Dart s, e)])
 -&gt; VertexData r (NonEmpty p))
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
-&gt; [VertexData r (NonEmpty p)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679980762"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679980762"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679980761"><span class="annot"><span class="annottext">sp :: SP (NonEmpty p) [(Dart s, e)]
</span><a href="#local-6989586621679980761"><span class="hs-identifier hs-var">sp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; NonEmpty p -&gt; VertexData r (NonEmpty p)
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980762"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SP (NonEmpty p) [(Dart s, e)]
</span><a href="#local-6989586621679980761"><span class="hs-identifier hs-var">sp</span></a></span><span class="annot"><span class="annottext">SP (NonEmpty p) [(Dart s, e)]
-&gt; Getting
     (NonEmpty p) (SP (NonEmpty p) [(Dart s, e)]) (NonEmpty p)
-&gt; NonEmpty p
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (NonEmpty p) (SP (NonEmpty p) [(Dart s, e)]) (NonEmpty p)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
 -&gt; Vector (VertexData r (NonEmpty p)))
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
-&gt; Vector (VertexData r (NonEmpty p))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
</span><a href="#local-6989586621679980769"><span class="hs-identifier hs-var">vts</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- The darts</span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679980794"><span class="annot"><span class="annottext">dts :: [[(Dart s, e)]]
</span><a href="#local-6989586621679980794"><span class="hs-identifier hs-var hs-var">dts</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point 2 r, SP (NonEmpty p) [(Dart s, e)]) -&gt; [(Dart s, e)])
-&gt; [(Point 2 r, SP (NonEmpty p) [(Dart s, e)])] -&gt; [[(Dart s, e)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r, SP (NonEmpty p) [(Dart s, e)])
-&gt; Getting
     [(Dart s, e)]
     (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
     [(Dart s, e)]
-&gt; [(Dart s, e)]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(SP (NonEmpty p) [(Dart s, e)]
 -&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)]))
-&gt; (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
-&gt; Const [(Dart s, e)] (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="annot"><span class="annottext">((SP (NonEmpty p) [(Dart s, e)]
  -&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)]))
 -&gt; (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
 -&gt; Const [(Dart s, e)] (Point 2 r, SP (NonEmpty p) [(Dart s, e)]))
-&gt; (([(Dart s, e)] -&gt; Const [(Dart s, e)] [(Dart s, e)])
    -&gt; SP (NonEmpty p) [(Dart s, e)]
    -&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)]))
-&gt; Getting
     [(Dart s, e)]
     (Point 2 r, SP (NonEmpty p) [(Dart s, e)])
     [(Dart s, e)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">([(Dart s, e)] -&gt; Const [(Dart s, e)] [(Dart s, e)])
-&gt; SP (NonEmpty p) [(Dart s, e)]
-&gt; Const [(Dart s, e)] (SP (NonEmpty p) [(Dart s, e)])
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, SP (NonEmpty p) [(Dart s, e)])]
</span><a href="#local-6989586621679980769"><span class="hs-identifier hs-var">vts</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- * Basic Graph information</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Get the number of vertices</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- &gt;&gt;&gt; numVertices smallG</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- 4</span><span>
</span><span id="line-241"></span><span id="local-6989586621679980755"><span id="local-6989586621679980756"><span id="local-6989586621679980757"><span id="local-6989586621679980758"><span id="local-6989586621679980759"><span class="annot"><a href="Data.PlaneGraph.Core.html#numVertices"><span class="hs-identifier hs-type">numVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980759"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980758"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980757"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980756"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980755"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-242"></span><span id="numVertices"><span class="annot"><span class="annottext">numVertices :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numVertices"><span class="hs-identifier hs-var hs-var">numVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numVertices</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Get the number of Darts</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- &gt;&gt;&gt; numDarts smallG</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- 10</span><span>
</span><span id="line-248"></span><span id="local-6989586621679980749"><span id="local-6989586621679980750"><span id="local-6989586621679980751"><span id="local-6989586621679980752"><span id="local-6989586621679980753"><span class="annot"><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier hs-type">numDarts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980753"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980752"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980751"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980750"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980749"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-249"></span><span id="numDarts"><span class="annot"><span class="annottext">numDarts :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numDarts"><span class="hs-identifier hs-var hs-var">numDarts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numDarts</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Get the number of Edges</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- &gt;&gt;&gt; numEdges smallG</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- 5</span><span>
</span><span id="line-255"></span><span id="local-6989586621679980743"><span id="local-6989586621679980744"><span id="local-6989586621679980745"><span id="local-6989586621679980746"><span id="local-6989586621679980747"><span class="annot"><a href="Data.PlaneGraph.Core.html#numEdges"><span class="hs-identifier hs-type">numEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980747"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980746"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980745"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980744"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980743"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-256"></span><span id="numEdges"><span class="annot"><span class="annottext">numEdges :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numEdges"><span class="hs-identifier hs-var hs-var">numEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numEdges</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Get the number of faces</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- &gt;&gt;&gt; numFaces smallG</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- 3</span><span>
</span><span id="line-262"></span><span id="local-6989586621679980737"><span id="local-6989586621679980738"><span id="local-6989586621679980739"><span id="local-6989586621679980740"><span id="local-6989586621679980741"><span class="annot"><a href="Data.PlaneGraph.Core.html#numFaces"><span class="hs-identifier hs-type">numFaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980741"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980740"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980739"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980738"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980737"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span><span>
</span><span id="line-263"></span><span id="numFaces"><span class="annot"><span class="annottext">numFaces :: PlaneGraph s v e f r -&gt; Int
</span><a href="Data.PlaneGraph.Core.html#numFaces"><span class="hs-identifier hs-var hs-var">numFaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int
forall k (s :: k) (w :: World) v e f. PlanarGraph s w v e f -&gt; Int
</span><span class="hs-identifier hs-var">PG.numFaces</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Int)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Enumerate all vertices</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- &gt;&gt;&gt; vertices' smallG</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- [VertexId 0,VertexId 1,VertexId 2,VertexId 3]</span><span>
</span><span id="line-269"></span><span id="local-6989586621679980731"><span id="local-6989586621679980732"><span id="local-6989586621679980733"><span id="local-6989586621679980734"><span id="local-6989586621679980735"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices%27"><span class="hs-identifier hs-type">vertices'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980735"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980734"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980733"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980732"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980731"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-270"></span><span id="vertices%27"><span class="annot"><span class="annottext">vertices' :: PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#vertices%27"><span class="hs-identifier hs-var hs-var">vertices'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (VertexId' s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (VertexId s w)
</span><span class="hs-identifier hs-var">PG.vertices'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Enumerate all vertices, together with their vertex data</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ vertices smallG</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- (VertexId 0,VertexData {_location = Point2 [0,0], _vData = 0})</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- (VertexId 1,VertexData {_location = Point2 [2,2], _vData = 1})</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- (VertexId 2,VertexData {_location = Point2 [2,0], _vData = 2})</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- (VertexId 3,VertexData {_location = Point2 [-1,4], _vData = 3})</span><span>
</span><span id="line-279"></span><span id="local-6989586621679981853"><span id="local-6989586621679981854"><span id="local-6989586621679981855"><span id="local-6989586621679981856"><span id="local-6989586621679981857"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-type">vertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981857"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981856"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981855"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981854"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981853"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981857"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981853"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981856"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-280"></span><span id="vertices"><span class="annot"><span class="annottext">vertices :: PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var hs-var">vertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Vector (VertexId' s, VertexData r v)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (VertexId s w, v)
</span><span class="hs-identifier hs-var">PG.vertices</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s, VertexData r v))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s, VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | Enumerate all darts</span><span>
</span><span id="line-283"></span><span id="local-6989586621679980724"><span id="local-6989586621679980725"><span id="local-6989586621679980726"><span id="local-6989586621679980727"><span id="local-6989586621679980728"><span class="annot"><a href="Data.PlaneGraph.Core.html#darts%27"><span class="hs-identifier hs-type">darts'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980728"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980727"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980726"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980725"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980724"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980728"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-284"></span><span id="darts%27"><span class="annot"><span class="annottext">darts' :: PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#darts%27"><span class="hs-identifier hs-var hs-var">darts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.darts'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Get all darts together with their data</span><span>
</span><span id="line-287"></span><span id="local-6989586621679980718"><span id="local-6989586621679980719"><span id="local-6989586621679980720"><span id="local-6989586621679980721"><span id="local-6989586621679980722"><span class="annot"><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier hs-type">darts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980722"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980721"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980720"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980719"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980718"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980722"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679980720"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-288"></span><span id="darts"><span class="annot"><span class="annottext">darts :: PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#darts"><span class="hs-identifier hs-var hs-var">darts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s, e)
</span><span class="hs-identifier hs-var">PG.darts</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s, e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Enumerate all edges. We report only the Positive darts</span><span>
</span><span id="line-291"></span><span id="local-6989586621679980712"><span id="local-6989586621679980713"><span id="local-6989586621679980714"><span id="local-6989586621679980715"><span id="local-6989586621679980716"><span class="annot"><a href="Data.PlaneGraph.Core.html#edges%27"><span class="hs-identifier hs-type">edges'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980716"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980715"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980714"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980713"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980712"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980716"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-292"></span><span id="edges%27"><span class="annot"><span class="annottext">edges' :: PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#edges%27"><span class="hs-identifier hs-var hs-var">edges'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.edges'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Lens to access the raw dart data, use at your own risk</span><span>
</span><span id="line-295"></span><span id="local-6989586621679980705"><span id="local-6989586621679980706"><span id="local-6989586621679980707"><span id="local-6989586621679980708"><span id="local-6989586621679980709"><span id="local-6989586621679980710"><span class="annot"><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-type">rawDartData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980710"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980709"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980708"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980707"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980706"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980710"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980709"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980705"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980707"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980706"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679980708"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679980705"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-297"></span><span id="rawDartData"><span class="annot"><span class="annottext">rawDartData :: (Vector e -&gt; f (Vector e'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var hs-var">rawDartData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r))
-&gt; ((Vector e -&gt; f (Vector e'))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; (Vector e -&gt; f (Vector e'))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e' f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector e -&gt; f (Vector e'))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k (s :: k) (w :: World) v e f e'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e' f)
  (Vector e)
  (Vector e')
</span><span class="hs-identifier hs-var">PG.rawDartData</span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | lens to access the Dart Data</span><span>
</span><span id="line-300"></span><span id="local-6989586621679980698"><span id="local-6989586621679980699"><span id="local-6989586621679980700"><span id="local-6989586621679980701"><span id="local-6989586621679980702"><span id="local-6989586621679980703"><span class="annot"><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier hs-type">dartData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980703"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980702"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980701"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980700"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980703"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980702"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980698"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980700"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980703"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679980701"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980703"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679980698"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-302"></span><span id="dartData"><span class="annot"><span class="annottext">dartData :: (Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
</span><a href="Data.PlaneGraph.Core.html#dartData"><span class="hs-identifier hs-var hs-var">dartData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e' f r))
-&gt; ((Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f))
-&gt; (Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e' f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; f (Vector (Dart s, e')))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k (s :: k) (w :: World) v e f e'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e' f)
  (Vector (Dart s, e))
  (Vector (Dart s, e'))
</span><span class="hs-identifier hs-var">PG.dartData</span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Lens to access face data</span><span>
</span><span id="line-305"></span><span id="local-6989586621679980691"><span id="local-6989586621679980692"><span id="local-6989586621679980693"><span id="local-6989586621679980694"><span id="local-6989586621679980695"><span id="local-6989586621679980696"><span class="annot"><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-type">faceData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980696"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980695"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980694"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980693"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980692"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980696"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980695"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980694"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980691"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980692"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679980693"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679980691"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-307"></span><span id="faceData"><span class="annot"><span class="annottext">faceData :: (Vector f -&gt; f (Vector f'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f' r)
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var hs-var">faceData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f' r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f'))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f' r))
-&gt; ((Vector f -&gt; f (Vector f'))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f'))
-&gt; (Vector f -&gt; f (Vector f'))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f' r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector f -&gt; f (Vector f'))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e f')
forall k (s :: k) (w :: World) v e f f'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e f')
  (Vector f)
  (Vector f')
</span><span class="hs-identifier hs-var">PG.faceData</span></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621679981292"><span id="local-6989586621679981293"><span id="local-6989586621679981294"><span id="local-6989586621679981295"><span id="local-6989586621679981296"><span id="local-6989586621679981297"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-type">vertexData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981297"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981296"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981295"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981294"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981293"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981297"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981292"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981295"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981294"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981293"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679981296"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679981292"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-311"></span><span id="vertexData"><span class="annot"><span class="annottext">vertexData :: (Vector v -&gt; f (Vector v'))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v' e f r)
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var hs-var">vertexData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; Vector v)
-&gt; (PlaneGraph s v e f r -&gt; Vector v' -&gt; PlaneGraph s v' e f r)
-&gt; Lens
     (PlaneGraph s v e f r)
     (PlaneGraph s v' e f r)
     (Vector v)
     (Vector v')
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector v
forall k (s :: k) v e f r. PlaneGraph s v e f r -&gt; Vector v
</span><a href="#local-6989586621679980689"><span class="hs-identifier hs-var">get''</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector v' -&gt; PlaneGraph s v' e f r
forall k (s :: k) v e f r v.
PlaneGraph s v e f r -&gt; Vector v -&gt; PlaneGraph s v e f r
</span><a href="#local-6989586621679980688"><span class="hs-identifier hs-var">set''</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621679980689"><span class="annot"><span class="annottext">get'' :: PlaneGraph s v e f r -&gt; Vector v
</span><a href="#local-6989586621679980689"><span class="hs-identifier hs-var hs-var">get''</span></a></span></span><span> </span><span id="local-6989586621679980687"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980687"><span class="hs-identifier hs-var">pg</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679980686"><span class="annot"><span class="annottext">v :: Vector (VertexData r v)
</span><a href="#local-6989586621679980686"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980687"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting
     (Vector (VertexData r v))
     (PlaneGraph s v e f r)
     (Vector (VertexData r v))
-&gt; Vector (VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Const
      (Vector (VertexData r v))
      (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r
-&gt; Const (Vector (VertexData r v)) (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; Const
       (Vector (VertexData r v))
       (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r
 -&gt; Const (Vector (VertexData r v)) (PlaneGraph s v e f r))
-&gt; ((Vector (VertexData r v)
     -&gt; Const (Vector (VertexData r v)) (Vector (VertexData r v)))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; Const
         (Vector (VertexData r v))
         (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; Getting
     (Vector (VertexData r v))
     (PlaneGraph s v e f r)
     (Vector (VertexData r v))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (VertexData r v)
 -&gt; Const (Vector (VertexData r v)) (Vector (VertexData r v)))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Const
     (Vector (VertexData r v))
     (PlanarGraph s 'Primal (VertexData r v) e f)
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r v -&gt; Getting v (VertexData r v) v -&gt; v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting v (VertexData r v) v
forall r v v. Lens (VertexData r v) (VertexData r v) v v
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; v) -&gt; Vector (VertexData r v) -&gt; Vector v
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexData r v)
</span><a href="#local-6989586621679980686"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679980688"><span class="annot"><span class="annottext">set'' :: PlaneGraph s v e f r -&gt; Vector v -&gt; PlaneGraph s v e f r
</span><a href="#local-6989586621679980688"><span class="hs-identifier hs-var hs-var">set''</span></a></span></span><span> </span><span id="local-6989586621679980685"><span class="annot"><span class="annottext">pg :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980685"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span id="local-6989586621679980684"><span class="annot"><span class="annottext">v' :: Vector v
</span><a href="#local-6989586621679980684"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980685"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; (PlaneGraph s v e f r -&gt; PlaneGraph s v e f r)
-&gt; PlaneGraph s v e f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; Identity (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; Identity (PlaneGraph s v e f r))
-&gt; ((Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
-&gt; PlaneGraph s v e f r
-&gt; Identity (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData r v) e f)
forall k (s :: k) (w :: World) v e f v'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v' e f)
  (Vector v)
  (Vector v')
</span><span class="hs-identifier hs-var">PG.vertexData</span></span><span> </span><span class="annot"><span class="annottext">((Vector (VertexData r v) -&gt; Identity (Vector (VertexData r v)))
 -&gt; PlaneGraph s v e f r -&gt; Identity (PlaneGraph s v e f r))
-&gt; (Vector (VertexData r v) -&gt; Vector (VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; PlaneGraph s v e f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; VertexData r v -&gt; VertexData r v)
-&gt; Vector v -&gt; Vector (VertexData r v) -&gt; Vector (VertexData r v)
forall a b c. (a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; VertexData r v -&gt; VertexData r v
forall v r v. v -&gt; VertexData r v -&gt; VertexData r v
</span><a href="#local-6989586621679980682"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v
</span><a href="#local-6989586621679980684"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679980682"><span class="annot"><span class="annottext">f :: v -&gt; VertexData r v -&gt; VertexData r v
</span><a href="#local-6989586621679980682"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679980681"><span class="annot"><span class="annottext">x :: v
</span><a href="#local-6989586621679980681"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span id="local-6989586621679980680"><span class="annot"><span class="annottext">l :: Point 2 r
</span><a href="#local-6989586621679980680"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; v -&gt; VertexData r v
forall r v. Point 2 r -&gt; v -&gt; VertexData r v
</span><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-var">VertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679980680"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679980681"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Enumerate all edges with their edge data. We report only the Positive</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- darts.</span><span>
</span><span id="line-319"></span><span class="hs-comment">--</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ edges smallG</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- (Dart (Arc 0) +1,&quot;0-&gt;2&quot;)</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- (Dart (Arc 1) +1,&quot;0-&gt;1&quot;)</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- (Dart (Arc 2) +1,&quot;0-&gt;3&quot;)</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- (Dart (Arc 4) +1,&quot;1-&gt;2&quot;)</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- (Dart (Arc 3) +1,&quot;1-&gt;3&quot;)</span><span>
</span><span id="line-326"></span><span id="local-6989586621679981154"><span id="local-6989586621679981155"><span id="local-6989586621679981156"><span id="local-6989586621679981157"><span id="local-6989586621679981158"><span class="annot"><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier hs-type">edges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981158"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981157"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981156"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981155"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981154"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981158"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679981156"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-327"></span><span id="edges"><span class="annot"><span class="annottext">edges :: PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (Dart s, e)
</span><span class="hs-identifier hs-var">PG.edges</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s, e))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s, e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Enumerate all faces in the plane graph</span><span>
</span><span id="line-330"></span><span id="local-6989586621679981101"><span id="local-6989586621679981102"><span id="local-6989586621679981103"><span id="local-6989586621679981104"><span id="local-6989586621679981105"><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-type">faces'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981105"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981104"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981103"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981102"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981101"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981105"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-331"></span><span id="faces%27"><span class="annot"><span class="annottext">faces' :: PlaneGraph s v e f r -&gt; Vector (FaceId' s)
</span><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-var hs-var">faces'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (FaceId' s)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (FaceId s w)
</span><span class="hs-identifier hs-var">PG.faces'</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (FaceId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | All faces with their face data.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ faces smallG</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- (FaceId 0,&quot;OuterFace&quot;)</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- (FaceId 1,&quot;A&quot;)</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- (FaceId 2,&quot;B&quot;)</span><span>
</span><span id="line-339"></span><span id="local-6989586621679981531"><span id="local-6989586621679981532"><span id="local-6989586621679981533"><span id="local-6989586621679981534"><span id="local-6989586621679981535"><span class="annot"><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-type">faces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981535"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981534"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981533"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981532"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981531"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981535"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679981532"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-340"></span><span id="faces"><span class="annot"><span class="annottext">faces :: PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-var hs-var">faces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (FaceId' s, f)
forall k (s :: k) (w :: World) v e f.
PlanarGraph s w v e f -&gt; Vector (FaceId s w, f)
</span><span class="hs-identifier hs-var">PG.faces</span></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (FaceId' s, f))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | Reports the outerface and all internal faces separately.</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-345"></span><span id="local-6989586621679981517"><span id="local-6989586621679981518"><span id="local-6989586621679981519"><span id="local-6989586621679981520"><span id="local-6989586621679981521"><span class="annot"><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier hs-type">faces''</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679981521"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679981521"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981520"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981519"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981518"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981517"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981521"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981520"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679981517"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981520"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679981517"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-347"></span><span id="faces%27%27"><span class="annot"><span class="annottext">faces'' :: PlaneGraph s v e f r -&gt; ((FaceId' s, f), Vector (FaceId' s, f))
</span><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier hs-var hs-var">faces''</span></a></span></span><span> </span><span id="local-6989586621679980676"><span class="annot"><span class="annottext">g :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980676"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679980675"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621679980675"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; FaceId' s
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980676"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-348"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980675"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980676"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980675"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((FaceId' s, f) -&gt; Bool)
-&gt; Vector (FaceId' s, f) -&gt; Vector (FaceId' s, f)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679980672"><span class="annot"><span class="annottext">j :: FaceId' s
</span><a href="#local-6989586621679980672"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980675"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; FaceId' s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980672"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s, f) -&gt; Vector (FaceId' s, f))
-&gt; Vector (FaceId' s, f) -&gt; Vector (FaceId' s, f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#faces"><span class="hs-identifier hs-var">faces</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980676"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | Reports all internal faces.</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-352"></span><span id="local-6989586621679980666"><span id="local-6989586621679980667"><span id="local-6989586621679980668"><span id="local-6989586621679980669"><span id="local-6989586621679980670"><span class="annot"><a href="Data.PlaneGraph.Core.html#internalFaces"><span class="hs-identifier hs-type">internalFaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679980670"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679980670"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980669"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980668"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980667"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980666"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980670"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980669"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679980666"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-354"></span><span id="internalFaces"><span class="annot"><span class="annottext">internalFaces :: PlaneGraph s v e f r -&gt; Vector (FaceId' s, f)
</span><a href="Data.PlaneGraph.Core.html#internalFaces"><span class="hs-identifier hs-var hs-var">internalFaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FaceId' s, f), Vector (FaceId' s, f)) -&gt; Vector (FaceId' s, f)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(((FaceId' s, f), Vector (FaceId' s, f)) -&gt; Vector (FaceId' s, f))
-&gt; (PlaneGraph s v e f r
    -&gt; ((FaceId' s, f), Vector (FaceId' s, f)))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; ((FaceId' s, f), Vector (FaceId' s, f))
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; ((FaceId' s, f), Vector (FaceId' s, f))
</span><a href="Data.PlaneGraph.Core.html#faces%27%27"><span class="hs-identifier hs-var">faces''</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | The tail of a dart, i.e. the vertex this dart is leaving from</span><span>
</span><span id="line-357"></span><span class="hs-comment">--</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-359"></span><span class="hs-comment">--</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- &gt;&gt;&gt; tailOf (dart 0 &quot;+1&quot;) smallG</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- VertexId 0</span><span>
</span><span id="line-362"></span><span id="local-6989586621679980661"><span id="local-6989586621679980662"><span id="local-6989586621679980663"><span id="local-6989586621679980664"><span id="local-6989586621679980665"><span class="annot"><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier hs-type">tailOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980665"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980665"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980664"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980663"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980662"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980661"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980665"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-363"></span><span id="tailOf"><span class="annot"><span class="annottext">tailOf :: Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#tailOf"><span class="hs-identifier hs-var hs-var">tailOf</span></a></span></span><span> </span><span id="local-6989586621679980660"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980660"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; VertexId s w
</span><span class="hs-identifier hs-var">PG.tailOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980660"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; VertexId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | The vertex this dart is heading in to</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- &gt;&gt;&gt; headOf (dart 0 &quot;+1&quot;) smallG</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- VertexId 2</span><span>
</span><span id="line-371"></span><span id="local-6989586621679980654"><span id="local-6989586621679980655"><span id="local-6989586621679980656"><span id="local-6989586621679980657"><span id="local-6989586621679980658"><span class="annot"><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier hs-type">headOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980658"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980658"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980657"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980656"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980655"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980654"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980658"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-372"></span><span id="headOf"><span class="annot"><span class="annottext">headOf :: Dart s -&gt; PlaneGraph s v e f r -&gt; VertexId' s
</span><a href="Data.PlaneGraph.Core.html#headOf"><span class="hs-identifier hs-var hs-var">headOf</span></a></span></span><span> </span><span id="local-6989586621679980653"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980653"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; VertexId s w
</span><span class="hs-identifier hs-var">PG.headOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980653"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; VertexId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; VertexId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- | endPoints d g = (tailOf d g, headOf d g)</span><span>
</span><span id="line-375"></span><span class="hs-comment">--</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-377"></span><span class="hs-comment">--</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- &gt;&gt;&gt; endPoints (dart 0 &quot;+1&quot;) smallG</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- (VertexId 0,VertexId 2)</span><span>
</span><span id="line-380"></span><span id="local-6989586621679980647"><span id="local-6989586621679980648"><span id="local-6989586621679980649"><span id="local-6989586621679980650"><span id="local-6989586621679980651"><span class="annot"><a href="Data.PlaneGraph.Core.html#endPoints"><span class="hs-identifier hs-type">endPoints</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980651"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980651"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980650"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980649"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980647"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980651"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980651"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-382"></span><span id="endPoints"><span class="annot"><span class="annottext">endPoints :: Dart s -&gt; PlaneGraph s v e f r -&gt; (VertexId' s, VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#endPoints"><span class="hs-identifier hs-var hs-var">endPoints</span></a></span></span><span> </span><span id="local-6989586621679980646"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980646"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; (VertexId' s, VertexId' s)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; (VertexId s w, VertexId s w)
</span><span class="hs-identifier hs-var">PG.endPoints</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980646"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; (VertexId' s, VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; (VertexId' s, VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | All edges incident to vertex v, in counterclockwise order around v.</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size</span><span>
</span><span id="line-387"></span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- &gt;&gt;&gt; incidentEdges (VertexId 1) smallG</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- [Dart (Arc 1) -1,Dart (Arc 4) +1,Dart (Arc 3) +1]</span><span>
</span><span id="line-390"></span><span id="local-6989586621679981166"><span id="local-6989586621679981167"><span id="local-6989586621679981168"><span id="local-6989586621679981169"><span id="local-6989586621679981170"><span class="annot"><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-type">incidentEdges</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981170"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981170"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981169"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981168"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981167"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981166"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981170"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-391"></span><span id="incidentEdges"><span class="annot"><span class="annottext">incidentEdges :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-var hs-var">incidentEdges</span></a></span></span><span> </span><span id="local-6989586621679980644"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980644"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.incidentEdges</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980644"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">-- | All edges incident to vertex v in incoming direction</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- (i.e. pointing into v) in counterclockwise order around v.</span><span>
</span><span id="line-396"></span><span class="hs-comment">--</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k) is the total number of incident edges of v</span><span>
</span><span id="line-398"></span><span class="hs-comment">--</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- &gt;&gt;&gt; incomingEdges (VertexId 1) smallG</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- [Dart (Arc 1) +1,Dart (Arc 4) -1,Dart (Arc 3) -1]</span><span>
</span><span id="line-401"></span><span id="local-6989586621679980638"><span id="local-6989586621679980639"><span id="local-6989586621679980640"><span id="local-6989586621679980641"><span id="local-6989586621679980642"><span class="annot"><a href="Data.PlaneGraph.Core.html#incomingEdges"><span class="hs-identifier hs-type">incomingEdges</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980641"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980640"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980639"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980638"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980642"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-402"></span><span id="incomingEdges"><span class="annot"><span class="annottext">incomingEdges :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incomingEdges"><span class="hs-identifier hs-var hs-var">incomingEdges</span></a></span></span><span> </span><span id="local-6989586621679980637"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980637"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.incomingEdges</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980637"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | All edges incident to vertex v in incoming direction</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- (i.e. pointing into v) in counterclockwise order around v.</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k) is the total number of incident edges of v</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- &gt;&gt;&gt; outgoingEdges (VertexId 1) smallG</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- [Dart (Arc 1) -1,Dart (Arc 4) +1,Dart (Arc 3) +1]</span><span>
</span><span id="line-413"></span><span id="local-6989586621679980631"><span id="local-6989586621679980632"><span id="local-6989586621679980633"><span id="local-6989586621679980634"><span id="local-6989586621679980635"><span class="annot"><a href="Data.PlaneGraph.Core.html#outgoingEdges"><span class="hs-identifier hs-type">outgoingEdges</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980635"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980635"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980634"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980633"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980632"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980631"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980635"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-414"></span><span id="outgoingEdges"><span class="annot"><span class="annottext">outgoingEdges :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#outgoingEdges"><span class="hs-identifier hs-var hs-var">outgoingEdges</span></a></span></span><span> </span><span id="local-6989586621679980630"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980630"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.outgoingEdges</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980630"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Gets the neighbours of a particular vertex, in counterclockwise order</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- around the vertex.</span><span>
</span><span id="line-418"></span><span class="hs-comment">--</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size</span><span>
</span><span id="line-420"></span><span class="hs-comment">--</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- &gt;&gt;&gt; neighboursOf (VertexId 1) smallG</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- [VertexId 0,VertexId 2,VertexId 3]</span><span>
</span><span id="line-423"></span><span id="local-6989586621679980624"><span id="local-6989586621679980625"><span id="local-6989586621679980626"><span id="local-6989586621679980627"><span id="local-6989586621679980628"><span class="annot"><a href="Data.PlaneGraph.Core.html#neighboursOf"><span class="hs-identifier hs-type">neighboursOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980628"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980628"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980627"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980626"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980625"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980624"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-424"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980628"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-425"></span><span id="neighboursOf"><span class="annot"><span class="annottext">neighboursOf :: VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#neighboursOf"><span class="hs-identifier hs-var hs-var">neighboursOf</span></a></span></span><span> </span><span id="local-6989586621679980623"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980623"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Vector (VertexId' s)
forall k (s :: k) (w :: World) v e f.
VertexId s w -&gt; PlanarGraph s w v e f -&gt; Vector (VertexId s w)
</span><span class="hs-identifier hs-var">PG.neighboursOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980623"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Given a dart d that points into some vertex v, report the next dart in the</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- cyclic order around v in clockwise direction.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-431"></span><span class="hs-comment">--</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- &gt;&gt;&gt; nextIncidentEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- Dart (Arc 2) +1</span><span>
</span><span id="line-434"></span><span id="local-6989586621679980617"><span id="local-6989586621679980618"><span id="local-6989586621679980619"><span id="local-6989586621679980620"><span id="local-6989586621679980621"><span class="annot"><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier hs-type">nextIncidentEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980621"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980621"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980620"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980619"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980618"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980617"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980621"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-435"></span><span id="nextIncidentEdge"><span class="annot"><span class="annottext">nextIncidentEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextIncidentEdge"><span class="hs-identifier hs-var hs-var">nextIncidentEdge</span></a></span></span><span> </span><span id="local-6989586621679980616"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980616"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.nextIncidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980616"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-comment">-- | Given a dart d that points into some vertex v, report the next dart in the</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- cyclic order around v (in clockwise order)</span><span>
</span><span id="line-439"></span><span class="hs-comment">--</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-441"></span><span class="hs-comment">--</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- &gt;&gt;&gt; prevIncidentEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- Dart (Arc 0) +1</span><span>
</span><span id="line-444"></span><span id="local-6989586621679980610"><span id="local-6989586621679980611"><span id="local-6989586621679980612"><span id="local-6989586621679980613"><span id="local-6989586621679980614"><span class="annot"><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier hs-type">prevIncidentEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980614"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980614"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980613"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980612"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980611"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980610"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980614"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-445"></span><span id="prevIncidentEdge"><span class="annot"><span class="annottext">prevIncidentEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevIncidentEdge"><span class="hs-identifier hs-var hs-var">prevIncidentEdge</span></a></span></span><span> </span><span id="local-6989586621679980609"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980609"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.prevIncidentEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980609"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- | The face to the left of the dart</span><span>
</span><span id="line-449"></span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-451"></span><span class="hs-comment">--</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 1 &quot;-1&quot;) smallG</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- FaceId 1</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 2 &quot;+1&quot;) smallG</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- FaceId 0</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- &gt;&gt;&gt; leftFace (dart 2 &quot;-1&quot;) smallG</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-460"></span><span id="local-6989586621679981207"><span id="local-6989586621679981208"><span id="local-6989586621679981209"><span id="local-6989586621679981210"><span id="local-6989586621679981211"><span class="annot"><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-type">leftFace</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981211"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981211"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981210"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981209"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981208"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981207"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981211"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-461"></span><span id="leftFace"><span class="annot"><span class="annottext">leftFace :: Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var hs-var">leftFace</span></a></span></span><span> </span><span id="local-6989586621679980607"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980607"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; FaceId s w
</span><span class="hs-identifier hs-var">PG.leftFace</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980607"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | The face to the right of the dart</span><span>
</span><span id="line-464"></span><span class="hs-comment">--</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-466"></span><span class="hs-comment">--</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- FaceId 1</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 1 &quot;-1&quot;) smallG</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 2 &quot;+1&quot;) smallG</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- FaceId 2</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- &gt;&gt;&gt; rightFace (dart 2 &quot;-1&quot;) smallG</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- FaceId 0</span><span>
</span><span id="line-475"></span><span id="local-6989586621679980601"><span id="local-6989586621679980602"><span id="local-6989586621679980603"><span id="local-6989586621679980604"><span id="local-6989586621679980605"><span class="annot"><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier hs-type">rightFace</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980605"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980605"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980604"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980603"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980602"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980601"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980605"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-476"></span><span id="rightFace"><span class="annot"><span class="annottext">rightFace :: Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#rightFace"><span class="hs-identifier hs-var hs-var">rightFace</span></a></span></span><span> </span><span id="local-6989586621679980600"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980600"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; FaceId s w
</span><span class="hs-identifier hs-var">PG.rightFace</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980600"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; FaceId' s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; FaceId' s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | Get the next edge along the face</span><span>
</span><span id="line-480"></span><span class="hs-comment">--</span><span>
</span><span id="line-481"></span><span class="hs-comment">--</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-483"></span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- &gt;&gt;&gt; nextEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- Dart (Arc 4) +1</span><span>
</span><span id="line-486"></span><span id="local-6989586621679980594"><span id="local-6989586621679980595"><span id="local-6989586621679980596"><span id="local-6989586621679980597"><span id="local-6989586621679980598"><span class="annot"><a href="Data.PlaneGraph.Core.html#nextEdge"><span class="hs-identifier hs-type">nextEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980598"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980598"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980597"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980596"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980595"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980594"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980598"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-487"></span><span id="nextEdge"><span class="annot"><span class="annottext">nextEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#nextEdge"><span class="hs-identifier hs-var hs-var">nextEdge</span></a></span></span><span> </span><span id="local-6989586621679980593"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980593"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.nextEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980593"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- | Get the previous edge along the face</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- running time: \(O(1)\).</span><span>
</span><span id="line-493"></span><span class="hs-comment">--</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- &gt;&gt;&gt; prevEdge (dart 1 &quot;+1&quot;) smallG</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- Dart (Arc 0) -1</span><span>
</span><span id="line-496"></span><span id="local-6989586621679980587"><span id="local-6989586621679980588"><span id="local-6989586621679980589"><span id="local-6989586621679980590"><span id="local-6989586621679980591"><span class="annot"><a href="Data.PlaneGraph.Core.html#prevEdge"><span class="hs-identifier hs-type">prevEdge</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980591"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980591"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980590"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980589"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980588"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980587"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980591"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-497"></span><span id="prevEdge"><span class="annot"><span class="annottext">prevEdge :: Dart s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#prevEdge"><span class="hs-identifier hs-var hs-var">prevEdge</span></a></span></span><span> </span><span id="local-6989586621679980586"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980586"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.prevEdge</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980586"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">-- | The darts bounding this face, for internal faces in clockwise order, for</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- the outer face in counter clockwise order.</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">--</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size.</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">--</span><span>
</span><span id="line-507"></span><span id="local-6989586621679980580"><span id="local-6989586621679980581"><span id="local-6989586621679980582"><span id="local-6989586621679980583"><span id="local-6989586621679980584"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier hs-type">boundary</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980584"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980584"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980583"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980582"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980581"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980580"><span class="hs-identifier hs-type">r</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980584"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-508"></span><span id="boundary"><span class="annot"><span class="annottext">boundary :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#boundary"><span class="hs-identifier hs-var hs-var">boundary</span></a></span></span><span> </span><span id="local-6989586621679980579"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621679980579"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
FaceId s w -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.boundary</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980579"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | Generates the darts incident to a face, starting with the given dart.</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">--</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- \(O(k)\), where \(k\) is the number of darts reported</span><span>
</span><span id="line-514"></span><span id="local-6989586621679980573"><span id="local-6989586621679980574"><span id="local-6989586621679980575"><span id="local-6989586621679980576"><span id="local-6989586621679980577"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier hs-type">boundary'</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980577"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980577"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980576"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980575"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980574"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980573"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980577"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-515"></span><span id="boundary%27"><span class="annot"><span class="annottext">boundary' :: Dart s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#boundary%27"><span class="hs-identifier hs-var hs-var">boundary'</span></a></span></span><span> </span><span id="local-6989586621679980572"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980572"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; Vector (Dart s)
</span><span class="hs-identifier hs-var">PG.boundary'</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980572"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Vector (Dart s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">-- | Gets a dart bounding this face. I.e. a dart d such that the face lies to</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- the right of the dart.</span><span>
</span><span id="line-519"></span><span id="local-6989586621679980566"><span id="local-6989586621679980567"><span id="local-6989586621679980568"><span id="local-6989586621679980569"><span id="local-6989586621679980570"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier hs-type">boundaryDart</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980570"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980570"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980569"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980568"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980567"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980566"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980570"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-520"></span><span id="boundaryDart"><span class="annot"><span class="annottext">boundaryDart :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#boundaryDart"><span class="hs-identifier hs-var hs-var">boundaryDart</span></a></span></span><span> </span><span id="local-6989586621679980565"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621679980565"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s
forall k (s :: k) (w :: World) v e f.
FaceId s w -&gt; PlanarGraph s w v e f -&gt; Dart s
</span><span class="hs-identifier hs-var">PG.boundaryDart</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980565"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f -&gt; Dart s)
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Dart s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- | The vertices bounding this face, for internal faces in clockwise order, for</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- the outer face in counter clockwise order.</span><span>
</span><span id="line-524"></span><span class="hs-comment">--</span><span>
</span><span id="line-525"></span><span class="hs-comment">--</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- running time: \(O(k)\), where \(k\) is the output size.</span><span>
</span><span id="line-527"></span><span id="local-6989586621679981125"><span id="local-6989586621679981126"><span id="local-6989586621679981127"><span id="local-6989586621679981128"><span id="local-6989586621679981129"><span class="annot"><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier hs-type">boundaryVertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981129"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981129"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981128"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981127"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981126"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981125"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-528"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981129"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-529"></span><span id="boundaryVertices"><span class="annot"><span class="annottext">boundaryVertices :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier hs-var hs-var">boundaryVertices</span></a></span></span><span> </span><span id="local-6989586621679980563"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621679980563"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Vector (VertexId' s)
forall k (s :: k) (w :: World) v e f.
FaceId s w -&gt; PlanarGraph s w v e f -&gt; Vector (VertexId s w)
</span><span class="hs-identifier hs-var">PG.boundaryVertices</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980563"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Vector (VertexId' s))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; Vector (VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- * Access data</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span id="local-6989586621679981335"><span id="local-6989586621679981336"><span id="local-6989586621679981337"><span id="local-6989586621679981338"><span id="local-6989586621679981339"><span class="annot"><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-type">vertexDataOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981338"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981337"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981336"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981335"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981335"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981338"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-536"></span><span id="vertexDataOf"><span class="annot"><span class="annottext">vertexDataOf :: VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-var hs-var">vertexDataOf</span></a></span></span><span> </span><span id="local-6989586621679980561"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980561"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((VertexData r v -&gt; f (VertexData r v))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (VertexData r v -&gt; f (VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">PG.dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980561"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span id="local-6989586621679980556"><span id="local-6989586621679980557"><span id="local-6989586621679980558"><span id="local-6989586621679980559"><span id="local-6989586621679980560"><span class="annot"><a href="Data.PlaneGraph.Core.html#locationOf"><span class="hs-identifier hs-type">locationOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980560"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980560"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980559"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980558"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980557"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980556"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679980556"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-539"></span><span id="locationOf"><span class="annot"><span class="annottext">locationOf :: VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#locationOf"><span class="hs-identifier hs-var hs-var">locationOf</span></a></span></span><span> </span><span id="local-6989586621679980555"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980555"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlaneGraph s v e f r) (VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertexDataOf"><span class="hs-identifier hs-var">vertexDataOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980555"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; f (VertexData r v))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((Point 2 r -&gt; f (Point 2 r))
    -&gt; VertexData r v -&gt; f (VertexData r v))
-&gt; (Point 2 r -&gt; f (Point 2 r))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; f (Point 2 r))
-&gt; VertexData r v -&gt; f (VertexData r v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span id="local-6989586621679980550"><span id="local-6989586621679980551"><span id="local-6989586621679980552"><span id="local-6989586621679980553"><span id="local-6989586621679980554"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980553"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980552"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980551"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980550"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980554"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980554"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980553"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980552"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980551"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980550"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980554"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679980553"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span id="local-6989586621679980547"><span class="annot"><span class="annottext">dataOf :: VertexId' s
-&gt; Lens'
     (PlaneGraph s v e f r)
     (DataOf (PlaneGraph s v e f r) (VertexId' s))
</span><a href="#local-6989586621679980547"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621679980546"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980546"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((v -&gt; f v)
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (v -&gt; f v)
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980546"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; f (VertexData r v))
 -&gt; PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; ((v -&gt; f v) -&gt; VertexData r v -&gt; f (VertexData r v))
-&gt; (v -&gt; f v)
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; f (PlanarGraph s 'Primal (VertexData r v) e f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(v -&gt; f v) -&gt; VertexData r v -&gt; f (VertexData r v)
forall r v v. Lens (VertexData r v) (VertexData r v) v v
</span><a href="Data.PlaneGraph.Core.html#vData"><span class="hs-identifier hs-var">vData</span></a></span></span></span></span></span></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span id="local-6989586621679980541"><span id="local-6989586621679980542"><span id="local-6989586621679980543"><span id="local-6989586621679980544"><span id="local-6989586621679980545"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980545"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980544"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980543"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980542"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980541"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980545"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980545"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980544"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980543"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980542"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980541"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980545"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679980543"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span id="local-6989586621679980539"><span class="annot"><span class="annottext">dataOf :: Dart s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (Dart s))
</span><a href="#local-6989586621679980539"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621679980538"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980538"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((e -&gt; f e)
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (e -&gt; f e)
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980538"><span class="hs-identifier hs-var">d</span></a></span></span></span></span></span></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span id="local-6989586621679980533"><span id="local-6989586621679980534"><span id="local-6989586621679980535"><span id="local-6989586621679980536"><span id="local-6989586621679980537"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasDataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980537"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980536"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980535"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980533"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980537"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DataOf"><span class="annot"><span class="hs-identifier hs-var">DataOf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980537"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980536"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980535"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980533"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980537"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679980534"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621679980531"><span class="annot"><span class="annottext">dataOf :: FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
</span><a href="#local-6989586621679980531"><span class="hs-identifier hs-var hs-var hs-var hs-var">dataOf</span></a></span></span><span> </span><span id="local-6989586621679980530"><span class="annot"><span class="annottext">f :: FaceId' s
</span><a href="#local-6989586621679980530"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; ((f -&gt; f f)
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (f -&gt; f f)
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980530"><span class="hs-identifier hs-var">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- | Traverse the vertices</span><span>
</span><span id="line-556"></span><span class="hs-comment">--</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- (^.vertexData) &lt;$&gt; traverseVertices (\i x -&gt; Just (i,x)) smallG</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- Just [(VertexId 0,0),(VertexId 1,1),(VertexId 2,2),(VertexId 3,3)]</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- &gt;&gt;&gt; traverseVertices (\i x -&gt; print (i,x)) smallG &gt;&gt; pure ()</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- (VertexId 0,0)</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- (VertexId 1,1)</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- (VertexId 2,2)</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- (VertexId 3,3)</span><span>
</span><span id="line-564"></span><span id="local-6989586621679980523"><span id="local-6989586621679980524"><span id="local-6989586621679980525"><span id="local-6989586621679980526"><span id="local-6989586621679980527"><span id="local-6989586621679980528"><span id="local-6989586621679980529"><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseVertices"><span class="hs-identifier hs-type">traverseVertices</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679980529"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-565"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980528"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980527"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980529"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980526"><span class="hs-identifier hs-type">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980528"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980527"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980525"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980524"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980523"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-567"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980529"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980528"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980526"><span class="hs-identifier hs-type">v'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980525"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980524"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980523"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-568"></span><span id="traverseVertices"><span class="annot"><span class="annottext">traverseVertices :: (VertexId' s -&gt; v -&gt; m v')
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r)
</span><a href="Data.PlaneGraph.Core.html#traverseVertices"><span class="hs-identifier hs-var hs-var">traverseVertices</span></a></span></span><span> </span><span id="local-6989586621679980522"><span class="annot"><span class="annottext">f :: VertexId' s -&gt; v -&gt; m v'
</span><a href="#local-6989586621679980522"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Indexed Int v (m v')
 -&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r))
-&gt; (Int -&gt; v -&gt; m v')
-&gt; PlaneGraph s v e f r
-&gt; m (PlaneGraph s v' e f r)
forall i a (f :: * -&gt; *) b s t.
(Indexed i a (f b) -&gt; s -&gt; f t) -&gt; (i -&gt; a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">itraverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Vector v -&gt; m (Vector v'))
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">vertexData</span></a></span><span class="annot"><span class="annottext">((Vector v -&gt; m (Vector v'))
 -&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v' e f r))
-&gt; (Indexed Int v (m v') -&gt; Vector v -&gt; m (Vector v'))
-&gt; Indexed Int v (m v')
-&gt; PlaneGraph s v e f r
-&gt; m (PlaneGraph s v' e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Indexed Int v (m v') -&gt; Vector v -&gt; m (Vector v')
forall i (t :: * -&gt; *) a b.
TraversableWithIndex i t =&gt;
IndexedTraversal i (t a) (t b) a b
</span><span class="hs-identifier hs-var">itraversed</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexId' s -&gt; v -&gt; m v'
</span><a href="#local-6989586621679980522"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; v -&gt; m v')
-&gt; (Int -&gt; VertexId' s) -&gt; Int -&gt; v -&gt; m v'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId' s
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="hs-comment">-- | Traverses the darts</span><span>
</span><span id="line-571"></span><span class="hs-comment">--</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- &gt;&gt;&gt; traverseDarts (\d x -&gt; print (d,x)) smallG &gt;&gt; pure ()</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- (Dart (Arc 0) +1,&quot;0-&gt;2&quot;)</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- (Dart (Arc 0) -1,&quot;2-&gt;0&quot;)</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- (Dart (Arc 1) +1,&quot;0-&gt;1&quot;)</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- (Dart (Arc 1) -1,&quot;1-&gt;0&quot;)</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- (Dart (Arc 2) +1,&quot;0-&gt;3&quot;)</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- (Dart (Arc 2) -1,&quot;3-&gt;0&quot;)</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- (Dart (Arc 3) +1,&quot;1-&gt;3&quot;)</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- (Dart (Arc 3) -1,&quot;3-&gt;1&quot;)</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- (Dart (Arc 4) +1,&quot;1-&gt;2&quot;)</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- (Dart (Arc 4) -1,&quot;2-&gt;1&quot;)</span><span>
</span><span id="line-583"></span><span id="local-6989586621679980512"><span id="local-6989586621679980513"><span id="local-6989586621679980514"><span id="local-6989586621679980515"><span id="local-6989586621679980516"><span id="local-6989586621679980517"><span id="local-6989586621679980518"><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseDarts"><span class="hs-identifier hs-type">traverseDarts</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679980518"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-584"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980517"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980516"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980518"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980515"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980517"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980514"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980516"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980513"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980512"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-586"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980518"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980517"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980514"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980515"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980513"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-587"></span><span id="traverseDarts"><span class="annot"><span class="annottext">traverseDarts :: (Dart s -&gt; e -&gt; m e')
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v e' f r)
</span><a href="Data.PlaneGraph.Core.html#traverseDarts"><span class="hs-identifier hs-var hs-var">traverseDarts</span></a></span></span><span> </span><span id="local-6989586621679980511"><span class="annot"><span class="annottext">f :: Dart s -&gt; e -&gt; m e'
</span><a href="#local-6989586621679980511"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e' f)
-&gt; LensLike
     m
     (PlaneGraph s v e f r)
     (PlaneGraph s v e' f r)
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (PlanarGraph s 'Primal (VertexData r v) e' f)
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s -&gt; e -&gt; m e')
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; m (PlanarGraph s 'Primal (VertexData r v) e' f)
forall k (m :: * -&gt; *) (s :: k) e e' (w :: World) v f.
Applicative m =&gt;
(Dart s -&gt; e -&gt; m e')
-&gt; PlanarGraph s w v e f -&gt; m (PlanarGraph s w v e' f)
</span><span class="hs-identifier hs-var">PG.traverseDarts</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; e -&gt; m e'
</span><a href="#local-6989586621679980511"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">-- | Traverses the faces</span><span>
</span><span id="line-591"></span><span class="hs-comment">--</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- &gt;&gt;&gt; traverseFaces (\i x -&gt; print (i,x)) smallG &gt;&gt; pure ()</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- (FaceId 0,&quot;OuterFace&quot;)</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- (FaceId 1,&quot;A&quot;)</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- (FaceId 2,&quot;B&quot;)</span><span>
</span><span id="line-596"></span><span id="local-6989586621679980502"><span id="local-6989586621679980503"><span id="local-6989586621679980504"><span id="local-6989586621679980505"><span id="local-6989586621679980506"><span id="local-6989586621679980507"><span id="local-6989586621679980508"><span class="annot"><a href="Data.PlaneGraph.Core.html#traverseFaces"><span class="hs-identifier hs-type">traverseFaces</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679980508"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-597"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980507"><span class="hs-identifier hs-type">s</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980506"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980508"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980505"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980507"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980504"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980503"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980506"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980502"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-599"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980508"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980507"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980504"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980503"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980505"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980502"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-600"></span><span id="traverseFaces"><span class="annot"><span class="annottext">traverseFaces :: (FaceId' s -&gt; f -&gt; m f')
-&gt; PlaneGraph s v e f r -&gt; m (PlaneGraph s v e f' r)
</span><a href="Data.PlaneGraph.Core.html#traverseFaces"><span class="hs-identifier hs-var hs-var">traverseFaces</span></a></span></span><span> </span><span id="local-6989586621679980501"><span class="annot"><span class="annottext">f :: FaceId' s -&gt; f -&gt; m f'
</span><a href="#local-6989586621679980501"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f')
-&gt; LensLike
     m
     (PlaneGraph s v e f r)
     (PlaneGraph s v e f' r)
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (PlanarGraph s 'Primal (VertexData r v) e f')
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  m
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f')
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FaceId' s -&gt; f -&gt; m f')
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; m (PlanarGraph s 'Primal (VertexData r v) e f')
forall k (m :: * -&gt; *) (s :: k) (w :: World) f f' v e.
Applicative m =&gt;
(FaceId s w -&gt; f -&gt; m f')
-&gt; PlanarGraph s w v e f -&gt; m (PlanarGraph s w v e f')
</span><span class="hs-identifier hs-var">PG.traverseFaces</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; f -&gt; m f'
</span><a href="#local-6989586621679980501"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-comment">-- | Getter for the data at the endpoints of a dart</span><span>
</span><span id="line-604"></span><span class="hs-comment">--</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-606"></span><span id="local-6989586621679981148"><span id="local-6989586621679981149"><span id="local-6989586621679981150"><span id="local-6989586621679981151"><span id="local-6989586621679981152"><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-type">endPointsOf</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981152"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981152"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981151"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981150"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981149"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981148"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981148"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981151"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981148"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981151"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-608"></span><span id="endPointsOf"><span class="annot"><span class="annottext">endPointsOf :: Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-var hs-var">endPointsOf</span></a></span></span><span> </span><span id="local-6989586621679980499"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980499"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r -&gt; f (PlaneGraph s v e f r))
-&gt; (((VertexData r v, VertexData r v)
     -&gt; f (VertexData r v, VertexData r v))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; f (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; ((VertexData r v, VertexData r v)
    -&gt; f (VertexData r v, VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; f (PlaneGraph s v e f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (VertexData r v, VertexData r v)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; Getter (PlanarGraph s w v e f) (v, v)
</span><span class="hs-identifier hs-var">PG.endPointDataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980499"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-comment">-- | Data corresponding to the endpoints of the dart</span><span>
</span><span id="line-611"></span><span class="hs-comment">--</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- running time: \(O(1)\)</span><span>
</span><span id="line-613"></span><span id="local-6989586621679981080"><span id="local-6989586621679981081"><span id="local-6989586621679981082"><span id="local-6989586621679981083"><span id="local-6989586621679981084"><span class="annot"><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier hs-type">endPointData</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981084"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981084"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981083"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981082"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981081"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981080"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-614"></span><span>               </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981080"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981083"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#VertexData"><span class="hs-identifier hs-type">VertexData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981080"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981083"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-615"></span><span id="endPointData"><span class="annot"><span class="annottext">endPointData :: Dart s -&gt; PlaneGraph s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier hs-var hs-var">endPointData</span></a></span></span><span> </span><span id="local-6989586621679980497"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980497"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; (VertexData r v, VertexData r v)
forall k (s :: k) (w :: World) v e f.
Dart s -&gt; PlanarGraph s w v e f -&gt; (v, v)
</span><span class="hs-identifier hs-var">PG.endPointData</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980497"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; (VertexData r v, VertexData r v))
-&gt; (PlaneGraph s v e f r
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f)
-&gt; PlaneGraph s v e f r
-&gt; (VertexData r v, VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; PlanarGraph s 'Primal (VertexData r v) e f
</span><a href="Data.PlaneGraph.Core.html#_graph"><span class="hs-identifier hs-var hs-var">_graph</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-comment">-- | gets the id of the outer face</span><span>
</span><span id="line-620"></span><span class="hs-comment">--</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-622"></span><span class="hs-comment">--</span><span>
</span><span id="line-623"></span><span id="local-6989586621679981542"><span id="local-6989586621679981543"><span id="local-6989586621679981544"><span id="local-6989586621679981545"><span id="local-6989586621679981546"><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-type">outerFaceId</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679981546"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679981546"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981545"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981544"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981543"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981542"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981546"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981545"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-624"></span><span id="outerFaceId"><span class="annot"><span class="annottext">outerFaceId :: PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#outerFaceId"><span class="hs-identifier hs-var hs-var">outerFaceId</span></a></span></span><span> </span><span id="local-6989586621679980495"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980495"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; FaceId' s
</span><a href="Data.PlaneGraph.Core.html#leftFace"><span class="hs-identifier hs-var">leftFace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Dart s
forall k r (s :: k) v e f.
(Ord r, Fractional r) =&gt;
PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-var">outerFaceDart</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980495"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980495"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- | gets a dart incident to the outer face (in particular, that has the</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- outerface on its left)</span><span>
</span><span id="line-629"></span><span class="hs-comment">--</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- running time: \(O(n)\)</span><span>
</span><span id="line-631"></span><span class="hs-comment">--</span><span>
</span><span id="line-632"></span><span id="local-6989586621679981201"><span id="local-6989586621679981202"><span id="local-6989586621679981203"><span id="local-6989586621679981204"><span id="local-6989586621679981205"><span class="annot"><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-type">outerFaceDart</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679981205"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679981205"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981204"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981203"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981202"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981201"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981205"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981204"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span><span>
</span><span id="line-633"></span><span id="outerFaceDart"><span class="annot"><span class="annottext">outerFaceDart :: PlaneGraph s v e f r -&gt; Dart s
</span><a href="Data.PlaneGraph.Core.html#outerFaceDart"><span class="hs-identifier hs-var hs-var">outerFaceDart</span></a></span></span><span> </span><span id="local-6989586621679980494"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980494"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980493"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679980492"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679980492"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((VertexId' s, VertexData r v)
 -&gt; (VertexId' s, VertexData r v) -&gt; Ordering)
-&gt; Vector (VertexId' s, VertexData r v)
-&gt; (VertexId' s, VertexData r v)
forall a. (a -&gt; a -&gt; Ordering) -&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((VertexId' s, VertexData r v) -&gt; Point 2 r)
-&gt; (VertexId' s, VertexData r v)
-&gt; (VertexId' s, VertexData r v)
-&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VertexId' s, VertexData r v)
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; (VertexId' s, VertexData r v)
-&gt; Const (Point 2 r) (VertexId' s, VertexData r v)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="annot"><span class="annottext">((VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
 -&gt; (VertexId' s, VertexData r v)
 -&gt; Const (Point 2 r) (VertexId' s, VertexData r v))
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v))
-&gt; Getting (Point 2 r) (VertexId' s, VertexData r v) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; VertexData r v -&gt; Const (Point 2 r) (VertexData r v)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (VertexId' s, VertexData r v)
 -&gt; (VertexId' s, VertexData r v))
-&gt; (PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v))
-&gt; PlaneGraph s v e f r
-&gt; (VertexId' s, VertexData r v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (VertexId' s, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; (VertexId' s, VertexData r v))
-&gt; PlaneGraph s v e f r -&gt; (VertexId' s, VertexData r v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980494"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-636"></span><span>           </span><span class="hs-comment">-- compare lexicographically; i.e. if same x-coord prefer the one with the</span><span>
</span><span id="line-637"></span><span>           </span><span class="hs-comment">-- smallest y-coord</span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621679980493"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980493"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Dart s :+ Line 2 r) -&gt; (Dart s :+ Line 2 r) -&gt; Ordering)
-&gt; Vector (Dart s :+ Line 2 r) -&gt; Dart s :+ Line 2 r
forall a. (a -&gt; a -&gt; Ordering) -&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Line 2 r -&gt; Line 2 r -&gt; Ordering
forall r. (Num r, Ord r) =&gt; Line 2 r -&gt; Line 2 r -&gt; Ordering
</span><a href="Data.Geometry.Line.Internal.html#cmpSlope"><span class="hs-identifier hs-var">cmpSlope</span></a></span><span> </span><span class="annot"><span class="annottext">(Line 2 r -&gt; Line 2 r -&gt; Ordering)
-&gt; ((Dart s :+ Line 2 r) -&gt; Line 2 r)
-&gt; (Dart s :+ Line 2 r)
-&gt; (Dart s :+ Line 2 r)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s :+ Line 2 r)
-&gt; Getting (Line 2 r) (Dart s :+ Line 2 r) (Line 2 r) -&gt; Line 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Line 2 r) (Dart s :+ Line 2 r) (Line 2 r)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>           </span><span class="annot"><span class="annottext">(Vector (Dart s :+ Line 2 r) -&gt; Dart s :+ Line 2 r)
-&gt; (Vector (Dart s) -&gt; Vector (Dart s :+ Line 2 r))
-&gt; Vector (Dart s)
-&gt; Dart s :+ Line 2 r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s :+ Line 2 r)
-&gt; Vector (Dart s) -&gt; Vector (Dart s :+ Line 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679980489"><span class="annot"><span class="annottext">d' :: Dart s
</span><a href="#local-6989586621679980489"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980489"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Line 2 r -&gt; Dart s :+ Line 2 r
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s v e f r -&gt; LineSegment 2 v r :+ e
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; LineSegment 2 v r :+ e
</span><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier hs-var">edgeSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980489"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980494"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 v r :+ e)
-&gt; Getting (Line 2 r) (LineSegment 2 v r :+ e) (Line 2 r)
-&gt; Line 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 v r -&gt; Const (Line 2 r) (LineSegment 2 v r))
-&gt; (LineSegment 2 v r :+ e)
-&gt; Const (Line 2 r) (LineSegment 2 v r :+ e)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="annot"><span class="annottext">((LineSegment 2 v r -&gt; Const (Line 2 r) (LineSegment 2 v r))
 -&gt; (LineSegment 2 v r :+ e)
 -&gt; Const (Line 2 r) (LineSegment 2 v r :+ e))
-&gt; ((Line 2 r -&gt; Const (Line 2 r) (Line 2 r))
    -&gt; LineSegment 2 v r -&gt; Const (Line 2 r) (LineSegment 2 v r))
-&gt; Getting (Line 2 r) (LineSegment 2 v r :+ e) (Line 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(LineSegment 2 v r -&gt; Line 2 r)
-&gt; (Line 2 r -&gt; Const (Line 2 r) (Line 2 r))
-&gt; LineSegment 2 v r
-&gt; Const (Line 2 r) (LineSegment 2 v r)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; Line 2 r
forall t.
HasSupportingLine t =&gt;
t -&gt; Line (Dimension t) (NumType t)
</span><a href="Data.Geometry.Line.Internal.html#supportingLine"><span class="hs-identifier hs-var">supportingLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>           </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Dart s :+ Line 2 r)
-&gt; Vector (Dart s) -&gt; Dart s :+ Line 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlaneGraph s v e f r -&gt; Vector (Dart s)
</span><a href="Data.PlaneGraph.Core.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980492"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980494"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-comment">-- based on the approach sketched at https://cstheory.stackexchange.com/questions/27586/finding-outer-face-in-plane-graph-embedded-planar-graph</span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-comment">-- basically: find the leftmost vertex, find the incident edge with the largest slope</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-comment">-- and take the face left of that edge. This is the outerface.</span><span>
</span><span id="line-644"></span><span>    </span><span class="hs-comment">-- note that this requires that the edges are straight line segments</span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- * Reporting Geometries</span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="hs-comment">-- | Reports all edges as line segments</span><span>
</span><span id="line-651"></span><span class="hs-comment">--</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- &gt;&gt;&gt; mapM_ print $ edgeSegments smallG</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- (Dart (Arc 0) +1,LineSegment (Closed (Point2 [0,0] :+ 0)) (Closed (Point2 [2,0] :+ 2)) :+ &quot;0-&gt;2&quot;)</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- (Dart (Arc 1) +1,LineSegment (Closed (Point2 [0,0] :+ 0)) (Closed (Point2 [2,2] :+ 1)) :+ &quot;0-&gt;1&quot;)</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- (Dart (Arc 2) +1,LineSegment (Closed (Point2 [0,0] :+ 0)) (Closed (Point2 [-1,4] :+ 3)) :+ &quot;0-&gt;3&quot;)</span><span>
</span><span id="line-656"></span><span class="hs-comment">-- (Dart (Arc 4) +1,LineSegment (Closed (Point2 [2,2] :+ 1)) (Closed (Point2 [2,0] :+ 2)) :+ &quot;1-&gt;2&quot;)</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- (Dart (Arc 3) +1,LineSegment (Closed (Point2 [2,2] :+ 1)) (Closed (Point2 [-1,4] :+ 3)) :+ &quot;1-&gt;3&quot;)</span><span>
</span><span id="line-658"></span><span id="local-6989586621679980483"><span id="local-6989586621679980484"><span id="local-6989586621679980485"><span id="local-6989586621679980486"><span id="local-6989586621679980487"><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegments"><span class="hs-identifier hs-type">edgeSegments</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980487"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980486"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980485"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980484"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980483"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679980487"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679980486"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980483"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679980485"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-659"></span><span id="edgeSegments"><span class="annot"><span class="annottext">edgeSegments :: PlaneGraph s v e f r -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
</span><a href="Data.PlaneGraph.Core.html#edgeSegments"><span class="hs-identifier hs-var hs-var">edgeSegments</span></a></span></span><span> </span><span id="local-6989586621679980482"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980482"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Dart s, e) -&gt; (Dart s, LineSegment 2 v r :+ e))
-&gt; Vector (Dart s, e) -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Dart s, e) -&gt; (Dart s, LineSegment 2 v r :+ e)
</span><a href="#local-6989586621679980481"><span class="hs-identifier hs-var">withSegment</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; Vector (Dart s, LineSegment 2 v r :+ e))
-&gt; (PlaneGraph s v e f r -&gt; Vector (Dart s, e))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (Dart s, e)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (Dart s, e)
</span><a href="Data.PlaneGraph.Core.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; Vector (Dart s, LineSegment 2 v r :+ e))
-&gt; PlaneGraph s v e f r -&gt; Vector (Dart s, LineSegment 2 v r :+ e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980482"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621679980481"><span class="annot"><span class="annottext">withSegment :: (Dart s, e) -&gt; (Dart s, LineSegment 2 v r :+ e)
</span><a href="#local-6989586621679980481"><span class="hs-identifier hs-var hs-var">withSegment</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980480"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980480"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679980479"><span class="annot"><span class="annottext">e :: e
</span><a href="#local-6989586621679980479"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980478"><span class="annot"><span class="annottext">p :: Point 2 r :+ v
</span><a href="#local-6989586621679980478"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679980477"><span class="annot"><span class="annottext">q :: Point 2 r :+ v
</span><a href="#local-6989586621679980477"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span>
</span><span id="line-662"></span><span>                                  </span><span class="annot"><span class="annottext">((VertexData r v, VertexData r v)
 -&gt; (Point 2 r :+ v, Point 2 r :+ v))
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980482"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting
     (VertexData r v, VertexData r v)
     (PlaneGraph s v e f r)
     (VertexData r v, VertexData r v)
-&gt; (VertexData r v, VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980480"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-663"></span><span>                            </span><span id="local-6989586621679980476"><span class="annot"><span class="annottext">seg :: LineSegment 2 v r
</span><a href="#local-6989586621679980476"><span class="hs-identifier hs-var hs-var">seg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; (Point 2 r :+ v) -&gt; LineSegment 2 v r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Data.Geometry.LineSegment.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621679980478"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621679980477"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-664"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980480"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r
</span><a href="#local-6989586621679980476"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; e -&gt; LineSegment 2 v r :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679980479"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Given a dart and the graph constructs the line segment representing the</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- dart. The segment \(\overline{uv})\) is has \(u\) as its tail and \(v\) as</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- its head.</span><span>
</span><span id="line-669"></span><span class="hs-comment">--</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- \(O(1)\)</span><span>
</span><span id="line-671"></span><span id="local-6989586621679981181"><span id="local-6989586621679981182"><span id="local-6989586621679981183"><span id="local-6989586621679981184"><span id="local-6989586621679981185"><span class="annot"><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier hs-type">edgeSegment</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679981185"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981185"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981184"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981183"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981182"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981181"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679981184"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981181"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679981183"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span></span><span>
</span><span id="line-672"></span><span id="edgeSegment"><span class="annot"><span class="annottext">edgeSegment :: Dart s -&gt; PlaneGraph s v e f r -&gt; LineSegment 2 v r :+ e
</span><a href="Data.PlaneGraph.Core.html#edgeSegment"><span class="hs-identifier hs-var hs-var">edgeSegment</span></a></span></span><span> </span><span id="local-6989586621679980474"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980474"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679980473"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980473"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r
</span><a href="#local-6989586621679980472"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 v r -&gt; e -&gt; LineSegment 2 v r :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980473"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting e (PlaneGraph s v e f r) e -&gt; e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679980472"><span class="annot"><span class="annottext">seg :: LineSegment 2 v r
</span><a href="#local-6989586621679980472"><span class="hs-identifier hs-var hs-var">seg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679980471"><span class="annot"><span class="annottext">p :: Point 2 r :+ v
</span><a href="#local-6989586621679980471"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679980470"><span class="annot"><span class="annottext">q :: Point 2 r :+ v
</span><a href="#local-6989586621679980470"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v -&gt; Point 2 r :+ v)
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span> </span><span class="annot"><span class="annottext">((VertexData r v, VertexData r v)
 -&gt; (Point 2 r :+ v, Point 2 r :+ v))
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r :+ v, Point 2 r :+ v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980473"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting
     (VertexData r v, VertexData r v)
     (PlaneGraph s v e f r)
     (VertexData r v, VertexData r v)
-&gt; (VertexData r v, VertexData r v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; Getter (PlaneGraph s v e f r) (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-675"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ v) -&gt; (Point 2 r :+ v) -&gt; LineSegment 2 v r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Data.Geometry.LineSegment.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621679980471"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ v
</span><a href="#local-6989586621679980470"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | The polygon describing the face</span><span>
</span><span id="line-678"></span><span class="hs-comment">--</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- runningtime: \(O(k)\), where \(k\) is the size of the face.</span><span>
</span><span id="line-680"></span><span class="hs-comment">--</span><span>
</span><span id="line-681"></span><span class="hs-comment">--</span><span>
</span><span id="line-682"></span><span id="local-6989586621679981113"><span id="local-6989586621679981114"><span id="local-6989586621679981115"><span id="local-6989586621679981116"><span id="local-6989586621679981117"><span class="annot"><a href="Data.PlaneGraph.Core.html#rawFaceBoundary"><span class="hs-identifier hs-type">rawFaceBoundary</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679981117"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981117"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981116"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981115"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981114"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981113"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-683"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981116"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981113"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679981114"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-684"></span><span id="rawFaceBoundary"><span class="annot"><span class="annottext">rawFaceBoundary :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#rawFaceBoundary"><span class="hs-identifier hs-var hs-var">rawFaceBoundary</span></a></span></span><span> </span><span id="local-6989586621679980469"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621679980469"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679980468"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980468"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r
</span><a href="#local-6989586621679980467"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon v r -&gt; f -&gt; SimplePolygon v r :+ f
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980468"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Getting f (PlaneGraph s v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' s
-&gt; Lens'
     (PlaneGraph s v e f r) (DataOf (PlaneGraph s v e f r) (FaceId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980469"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-686"></span><span>    </span><span id="local-6989586621679980467"><span class="annot"><span class="annottext">pg :: SimplePolygon v r
</span><a href="#local-6989586621679980467"><span class="hs-identifier hs-var hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ v] -&gt; SimplePolygon v r
forall r p. [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#fromPoints"><span class="hs-identifier hs-var">fromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r :+ v] -&gt; SimplePolygon v r)
-&gt; (PlaneGraph s v e f r -&gt; [Point 2 r :+ v])
-&gt; PlaneGraph s v e f r
-&gt; SimplePolygon v r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point 2 r :+ v) -&gt; [Point 2 r :+ v]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Point 2 r :+ v) -&gt; [Point 2 r :+ v])
-&gt; (PlaneGraph s v e f r -&gt; Vector (Point 2 r :+ v))
-&gt; PlaneGraph s v e f r
-&gt; [Point 2 r :+ v]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; Point 2 r :+ v)
-&gt; Vector (VertexId' s) -&gt; Vector (Point 2 r :+ v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679980465"><span class="annot"><span class="annottext">j :: VertexId' s
</span><a href="#local-6989586621679980465"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980468"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlaneGraph s v e f r
-&gt; Getting (Point 2 r :+ v) (PlaneGraph s v e f r) (Point 2 r :+ v)
-&gt; Point 2 r :+ v
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Const
      (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; PlaneGraph s v e f r
-&gt; Const (Point 2 r :+ v) (PlaneGraph s v e f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r v) e f
  -&gt; Const
       (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
 -&gt; PlaneGraph s v e f r
 -&gt; Const (Point 2 r :+ v) (PlaneGraph s v e f r))
-&gt; (((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
    -&gt; PlanarGraph s 'Primal (VertexData r v) e f
    -&gt; Const
         (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; Getting (Point 2 r :+ v) (PlaneGraph s v e f r) (Point 2 r :+ v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens'
     (PlanarGraph s 'Primal (VertexData r v) e f)
     (DataOf (PlanarGraph s 'Primal (VertexData r v) e f) (VertexId' s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679980465"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">((VertexData r v -&gt; Const (Point 2 r :+ v) (VertexData r v))
 -&gt; PlanarGraph s 'Primal (VertexData r v) e f
 -&gt; Const
      (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f))
-&gt; (((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
    -&gt; VertexData r v -&gt; Const (Point 2 r :+ v) (VertexData r v))
-&gt; ((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
-&gt; PlanarGraph s 'Primal (VertexData r v) e f
-&gt; Const
     (Point 2 r :+ v) (PlanarGraph s 'Primal (VertexData r v) e f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexData r v -&gt; Point 2 r :+ v)
-&gt; ((Point 2 r :+ v) -&gt; Const (Point 2 r :+ v) (Point 2 r :+ v))
-&gt; VertexData r v
-&gt; Const (Point 2 r :+ v) (VertexData r v)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">VertexData r v -&gt; Point 2 r :+ v
forall r v. VertexData r v -&gt; Point 2 r :+ v
</span><a href="Data.PlaneGraph.Core.html#vtxDataToExt"><span class="hs-identifier hs-var">vtxDataToExt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>       </span><span class="annot"><span class="annottext">(Vector (VertexId' s) -&gt; Vector (Point 2 r :+ v))
-&gt; (PlaneGraph s v e f r -&gt; Vector (VertexId' s))
-&gt; PlaneGraph s v e f r
-&gt; Vector (Point 2 r :+ v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.PlaneGraph.Core.html#boundaryVertices"><span class="hs-identifier hs-var">boundaryVertices</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980469"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r -&gt; SimplePolygon v r)
-&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980468"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span class="hs-comment">-- | Alias for rawFace Boundary</span><span>
</span><span id="line-690"></span><span class="hs-comment">--</span><span>
</span><span id="line-691"></span><span class="hs-comment">-- runningtime: \(O(k)\), where \(k\) is the size of the face.</span><span>
</span><span id="line-692"></span><span id="local-6989586621679980460"><span id="local-6989586621679980461"><span id="local-6989586621679980462"><span id="local-6989586621679980463"><span id="local-6989586621679980464"><span class="annot"><a href="Data.PlaneGraph.Core.html#rawFacePolygon"><span class="hs-identifier hs-type">rawFacePolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980464"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980464"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980463"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980462"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980461"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980460"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980463"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980460"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679980461"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-693"></span><span id="rawFacePolygon"><span class="annot"><span class="annottext">rawFacePolygon :: FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#rawFacePolygon"><span class="hs-identifier hs-var hs-var">rawFacePolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#rawFaceBoundary"><span class="hs-identifier hs-var">rawFaceBoundary</span></a></span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-comment">-- | Lists all faces of the plane graph.</span><span>
</span><span id="line-696"></span><span id="local-6989586621679980455"><span id="local-6989586621679980456"><span id="local-6989586621679980457"><span id="local-6989586621679980458"><span id="local-6989586621679980459"><span class="annot"><a href="Data.PlaneGraph.Core.html#rawFacePolygons"><span class="hs-identifier hs-type">rawFacePolygons</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980459"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980458"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980457"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980456"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980455"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-697"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679980459"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980458"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980455"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679980456"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-698"></span><span id="rawFacePolygons"><span class="annot"><span class="annottext">rawFacePolygons :: PlaneGraph s v e f r -&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
</span><a href="Data.PlaneGraph.Core.html#rawFacePolygons"><span class="hs-identifier hs-var hs-var">rawFacePolygons</span></a></span></span><span> </span><span id="local-6989586621679980454"><span class="annot"><span class="annottext">ps :: PlaneGraph s v e f r
</span><a href="#local-6989586621679980454"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FaceId' s -&gt; (FaceId' s, SimplePolygon v r :+ f))
-&gt; Vector (FaceId' s) -&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679980453"><span class="annot"><span class="annottext">i :: FaceId' s
</span><a href="#local-6989586621679980453"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980453"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
forall k (s :: k) v e f r.
FaceId' s -&gt; PlaneGraph s v e f r -&gt; SimplePolygon v r :+ f
</span><a href="Data.PlaneGraph.Core.html#rawFacePolygon"><span class="hs-identifier hs-var">rawFacePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679980453"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980454"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (FaceId' s) -&gt; Vector (FaceId' s, SimplePolygon v r :+ f))
-&gt; (PlaneGraph s v e f r -&gt; Vector (FaceId' s))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r -&gt; Vector (FaceId' s)
forall k (s :: k) v e f r.
PlaneGraph s v e f r -&gt; Vector (FaceId' s)
</span><a href="Data.PlaneGraph.Core.html#faces%27"><span class="hs-identifier hs-var">faces'</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph s v e f r
 -&gt; Vector (FaceId' s, SimplePolygon v r :+ f))
-&gt; PlaneGraph s v e f r
-&gt; Vector (FaceId' s, SimplePolygon v r :+ f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s v e f r
</span><a href="#local-6989586621679980454"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-comment">-- | Labels the edges of a plane graph with their distances, as specified by</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- the distance function.</span><span>
</span><span id="line-704"></span><span id="local-6989586621679980447"><span id="local-6989586621679980448"><span id="local-6989586621679980449"><span id="local-6989586621679980450"><span id="local-6989586621679980451"><span id="local-6989586621679980452"><span class="annot"><a href="Data.PlaneGraph.Core.html#withEdgeDistances"><span class="hs-identifier hs-type">withEdgeDistances</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679980452"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679980452"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679980451"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980450"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980449"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980448"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980447"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980452"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.PlaneGraph.Core.html#PlaneGraph"><span class="hs-identifier hs-type">PlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980450"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980449"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679980451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679980448"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679980447"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679980452"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-706"></span><span id="withEdgeDistances"><span class="annot"><span class="annottext">withEdgeDistances :: (Point 2 r -&gt; Point 2 r -&gt; a)
-&gt; PlaneGraph s p e f r -&gt; PlaneGraph s p (a :+ e) f r
</span><a href="Data.PlaneGraph.Core.html#withEdgeDistances"><span class="hs-identifier hs-var hs-var">withEdgeDistances</span></a></span></span><span> </span><span id="local-6989586621679980446"><span class="annot"><span class="annottext">f :: Point 2 r -&gt; Point 2 r -&gt; a
</span><a href="#local-6989586621679980446"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679980445"><span class="annot"><span class="annottext">g :: PlaneGraph s p e f r
</span><a href="#local-6989586621679980445"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlaneGraph s p e f r
</span><a href="#local-6989586621679980445"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">PlaneGraph s p e f r
-&gt; (PlaneGraph s p e f r -&gt; PlaneGraph s p (a :+ e) f r)
-&gt; PlaneGraph s p (a :+ e) f r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(PlanarGraph s 'Primal (VertexData r p) e f
 -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f))
-&gt; PlaneGraph s p e f r -&gt; Identity (PlaneGraph s p (a :+ e) f r)
forall k k (s :: k) v e f r (s :: k) v e f r.
Iso
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f r)
  (PlanarGraph s 'Primal (VertexData r v) e f)
  (PlanarGraph s 'Primal (VertexData r v) e f)
</span><a href="Data.PlaneGraph.Core.html#graph"><span class="hs-identifier hs-var">graph</span></a></span><span class="annot"><span class="annottext">((PlanarGraph s 'Primal (VertexData r p) e f
  -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f))
 -&gt; PlaneGraph s p e f r -&gt; Identity (PlaneGraph s p (a :+ e) f r))
-&gt; ((Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
    -&gt; PlanarGraph s 'Primal (VertexData r p) e f
    -&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f))
-&gt; (Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
-&gt; PlaneGraph s p e f r
-&gt; Identity (PlaneGraph s p (a :+ e) f r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
-&gt; PlanarGraph s 'Primal (VertexData r p) e f
-&gt; Identity (PlanarGraph s 'Primal (VertexData r p) (a :+ e) f)
forall k (s :: k) (w :: World) v e f e'.
Lens
  (PlanarGraph s w v e f)
  (PlanarGraph s w v e' f)
  (Vector (Dart s, e))
  (Vector (Dart s, e'))
</span><span class="hs-identifier hs-var">PG.dartData</span></span><span> </span><span class="annot"><span class="annottext">((Vector (Dart s, e) -&gt; Identity (Vector (Dart s, a :+ e)))
 -&gt; PlaneGraph s p e f r -&gt; Identity (PlaneGraph s p (a :+ e) f r))
-&gt; (Vector (Dart s, e) -&gt; Vector (Dart s, a :+ e))
-&gt; PlaneGraph s p e f r
-&gt; PlaneGraph s p (a :+ e) f r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">((Dart s, e) -&gt; (Dart s, a :+ e))
-&gt; Vector (Dart s, e) -&gt; Vector (Dart s, a :+ e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679980444"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980444"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679980443"><span class="annot"><span class="annottext">x :: e
</span><a href="#local-6989586621679980443"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980444"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dart s -&gt; a
</span><a href="#local-6989586621679980442"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980444"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; e -&gt; a :+ e
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679980443"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679980442"><span class="annot"><span class="annottext">len :: Dart s -&gt; a
</span><a href="#local-6989586621679980442"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679980441"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679980441"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 r -&gt; a) -&gt; (Point 2 r, Point 2 r) -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; a
</span><a href="#local-6989586621679980446"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Point 2 r) -&gt; a)
-&gt; ((VertexData r p, VertexData r p) -&gt; (Point 2 r, Point 2 r))
-&gt; (VertexData r p, VertexData r p)
-&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (VertexData r p, VertexData r p)
  (Point 2 r, Point 2 r)
  (VertexData r p)
  (Point 2 r)
-&gt; (VertexData r p -&gt; Point 2 r)
-&gt; (VertexData r p, VertexData r p)
-&gt; (Point 2 r, Point 2 r)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (VertexData r p, VertexData r p)
  (Point 2 r, Point 2 r)
  (VertexData r p)
  (Point 2 r)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r p
-&gt; Getting (Point 2 r) (VertexData r p) (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point 2 r) (VertexData r p) (Point 2 r)
forall r v r.
Lens (VertexData r v) (VertexData r v) (Point 2 r) (Point 2 r)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((VertexData r p, VertexData r p) -&gt; a)
-&gt; (VertexData r p, VertexData r p) -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlaneGraph s p e f r -&gt; (VertexData r p, VertexData r p)
forall k (s :: k) v e f r.
Dart s -&gt; PlaneGraph s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Data.PlaneGraph.Core.html#endPointData"><span class="hs-identifier hs-var">endPointData</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679980441"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlaneGraph s p e f r
</span><a href="#local-6989586621679980445"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-709"></span></pre></body></html>